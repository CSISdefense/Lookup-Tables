UPDATE T SET
[transaction_status]=S.[transaction_status],
[obligatedamount]=S.[obligatedamount],
[baseandexercisedoptionsvalue]=S.[baseandexercisedoptionsvalue],
[baseandalloptionsvalue]=S.[baseandalloptionsvalue],
[maj_agency_cat]=S.[maj_agency_cat],
[mod_agency]=coalesce(nullif(S.[mod_agency],''),T.[mod_agency]),
[maj_fund_agency_cat]=S.[maj_fund_agency_cat],
[contractingofficeagencyid]=S.[contractingofficeagencyid],
[contractingofficeid]=S.[contractingofficeid],
[fundingrequestingagencyid]=S.[fundingrequestingagencyid],
[fundingrequestingofficeid]=S.[fundingrequestingofficeid],
[fundedbyforeignentity]=S.[fundedbyforeignentity],
[signeddate]=S.[signeddate],
[effectivedate]=S.[effectivedate],
[currentcompletiondate]=S.[currentcompletiondate],
[ultimatecompletiondate]=S.[ultimatecompletiondate],
[lastdatetoorder]=S.[lastdatetoorder],
[contractactiontype]=S.[contractactiontype],
[reasonformodification]=S.[reasonformodification],
[typeofcontractpricing]=S.[typeofcontractpricing],
[priceevaluationpercentdifference]=S.[priceevaluationpercentdifference],
[subcontractplan]=S.[subcontractplan],
[lettercontract]=coalesce(nullif(S.[lettercontract],''),T.[lettercontract]),
[multiyearcontract]=S.[multiyearcontract],
[performancebasedservicecontract]=S.[performancebasedservicecontract],
[majorprogramcode]=coalesce(nullif(S.[majorprogramcode],''),T.[majorprogramcode]),
[contingencyhumanitarianpeacekeepingoperation]=S.[contingencyhumanitarianpeacekeepingoperation],
[contractfinancing]=S.[contractfinancing],
[costorpricingdata]=S.[costorpricingdata],
[costaccountingstandardsclause]=S.[costaccountingstandardsclause],
[descriptionofcontractrequirement]=S.[descriptionofcontractrequirement],
[purchasecardaspaymentmethod]=S.[purchasecardaspaymentmethod],
[numberofactions]=S.[numberofactions],
[nationalinterestactioncode]=S.[nationalinterestactioncode],
[progsourceagency]=S.[progsourceagency],
[progsourceaccount]=S.[progsourceaccount],
[progsourcesubacct]=coalesce(nullif(S.[progsourcesubacct],''),T.[progsourcesubacct]),
[account_title]=coalesce(nullif(S.[account_title],''),T.[account_title]),
[rec_flag]=coalesce(nullif(S.[rec_flag],''),T.[rec_flag]),
[typeofidc]=S.[typeofidc],
[multipleorsingleawardidc]=S.[multipleorsingleawardidc],
[programacronym]=S.[programacronym],
[vendorname]=S.[vendorname],
[vendoralternatename]=S.[vendoralternatename],
[vendorlegalorganizationname]=S.[vendorlegalorganizationname],
[vendordoingasbusinessname]=S.[vendordoingasbusinessname],
[divisionname]=S.[divisionname],
[divisionnumberorofficecode]=S.[divisionnumberorofficecode],
[vendorenabled]=S.[vendorenabled],
[vendorlocationdisableflag]=S.[vendorlocationdisableflag],
[ccrexception]=S.[ccrexception],
[streetaddress]=S.[streetaddress],
[streetaddress2]=S.[streetaddress2],
[streetaddress3]=S.[streetaddress3],
[city]=S.[city],
[state]=S.[state],
[zipcode]=S.[zipcode],
[vendorcountrycode]=S.[vendorcountrycode],
[vendor_state_code]=S.[vendor_state_code],
[vendor_cd]=S.[vendor_cd],
[congressionaldistrict]=S.[congressionaldistrict],
[vendorsitecode]=S.[vendorsitecode],
[vendoralternatesitecode]=S.[vendoralternatesitecode],
[dunsnumber]=S.[dunsnumber],
[parentdunsnumber]=coalesce(nullif(S.[parentdunsnumber],''),T.[parentdunsnumber]),
[phoneno]=S.[phoneno],
[faxno]=S.[faxno],
[registrationdate]=S.[registrationdate],
[renewaldate]=S.[renewaldate],
[mod_parent]=S.[mod_parent],
[locationcode]=coalesce(nullif(S.[locationcode],''),T.[locationcode]),
[statecode]=coalesce(nullif(S.[statecode],''),T.[statecode]),
[pop_state_code]=S.[pop_state_code],
[placeofperformancecountrycode]=S.[placeofperformancecountrycode],
[placeofperformancezipcode]=S.[placeofperformancezipcode],
[pop_cd]=S.[pop_cd],
[placeofperformancecongressionaldistrict]=S.[placeofperformancecongressionaldistrict],
[psc_cat]=S.[psc_cat],
[productorservicecode]=S.[productorservicecode],
[systemequipmentcode]=S.[systemequipmentcode],
[claimantprogramcode]=S.[claimantprogramcode],
[principalnaicscode]=S.[principalnaicscode],
[informationtechnologycommercialitemcategory]=S.[informationtechnologycommercialitemcategory],
[gfe_gfp]=S.[gfe_gfp],
[useofepadesignatedproducts]=S.[useofepadesignatedproducts],
[recoveredmaterialclauses]=S.[recoveredmaterialclauses],
[seatransportation]=S.[seatransportation],
[contractbundling]=S.[contractbundling],
[consolidatedcontract]=S.[consolidatedcontract],
[countryoforigin]=S.[countryoforigin],
[placeofmanufacture]=S.[placeofmanufacture],
[manufacturingorganizationtype]=S.[manufacturingorganizationtype],
[agencyid]=S.[agencyid],
[piid]=S.[piid],
[modnumber]=S.[modnumber],
[transactionnumber]=S.[transactionnumber],
[idvagencyid]=S.[idvagencyid],
[idvpiid]=S.[idvpiid],
[idvmodificationnumber]=S.[idvmodificationnumber],
[solicitationid]=S.[solicitationid],
[extentcompeted]=S.[extentcompeted],
[reasonnotcompeted]=S.[reasonnotcompeted],
[numberofoffersreceived]=S.[numberofoffersreceived],
[commercialitemacquisitionprocedures]=S.[commercialitemacquisitionprocedures],
[commercialitemtestprogram]=S.[commercialitemtestprogram],
[smallbusinesscompetitivenessdemonstrationprogram]=coalesce(nullif(S.[smallbusinesscompetitivenessdemonstrationprogram],''),T.[smallbusinesscompetitivenessdemonstrationprogram]),
[a76action]=S.[a76action],
[competitiveprocedures]=S.[competitiveprocedures],
[solicitationprocedures]=S.[solicitationprocedures],
[typeofsetaside]=S.[typeofsetaside],
[localareasetaside]=S.[localareasetaside],
[evaluatedpreference]=S.[evaluatedpreference],
[fedbizopps]=S.[fedbizopps],
[research]=S.[research],
[statutoryexceptiontofairopportunity]=S.[statutoryexceptiontofairopportunity],
[organizationaltype]=S.[organizationaltype],
[numberofemployees]=S.[numberofemployees],
[annualrevenue]=S.[annualrevenue],
[firm8aflag]=S.[firm8aflag],
[hubzoneflag]=S.[hubzoneflag],
[sdbflag]=S.[sdbflag],
[issbacertifiedsmalldisadvantagedbusiness]=S.[issbacertifiedsmalldisadvantagedbusiness],
[shelteredworkshopflag]=S.[shelteredworkshopflag],
[hbcuflag]=S.[hbcuflag],
[educationalinstitutionflag]=S.[educationalinstitutionflag],
[womenownedflag]=S.[womenownedflag],
[veteranownedflag]=S.[veteranownedflag],
[srdvobflag]=S.[srdvobflag],
[localgovernmentflag]=S.[localgovernmentflag],
[minorityinstitutionflag]=S.[minorityinstitutionflag],
[aiobflag]=S.[aiobflag],
[stategovernmentflag]=S.[stategovernmentflag],
[federalgovernmentflag]=S.[federalgovernmentflag],
[minorityownedbusinessflag]=S.[minorityownedbusinessflag],
[apaobflag]=S.[apaobflag],
[tribalgovernmentflag]=S.[tribalgovernmentflag],
[baobflag]=S.[baobflag],
[naobflag]=S.[naobflag],
[saaobflag]=S.[saaobflag],
[nonprofitorganizationflag]=S.[nonprofitorganizationflag],
[isothernotforprofitorganization]=S.[isothernotforprofitorganization],
[isforprofitorganization]=S.[isforprofitorganization],
[isfoundation]=S.[isfoundation],
[haobflag]=S.[haobflag],
[ishispanicservicinginstitution]=S.[ishispanicservicinginstitution],
[emergingsmallbusinessflag]=S.[emergingsmallbusinessflag],
[hospitalflag]=S.[hospitalflag],
[contractingofficerbusinesssizedetermination]=S.[contractingofficerbusinesssizedetermination],
[is1862landgrantcollege]=S.[is1862landgrantcollege],
[is1890landgrantcollege]=S.[is1890landgrantcollege],
[is1994landgrantcollege]=S.[is1994landgrantcollege],
[isveterinarycollege]=S.[isveterinarycollege],
[isveterinaryhospital]=S.[isveterinaryhospital],
[isprivateuniversityorcollege]=S.[isprivateuniversityorcollege],
[isschoolofforestry]=S.[isschoolofforestry],
[isstatecontrolledinstitutionofhigherlearning]=S.[isstatecontrolledinstitutionofhigherlearning],
[isserviceprovider]=S.[isserviceprovider],
[receivescontracts]=S.[receivescontracts],
[receivesgrants]=S.[receivesgrants],
[receivescontractsandgrants]=S.[receivescontractsandgrants],
[isairportauthority]=S.[isairportauthority],
[iscouncilofgovernments]=S.[iscouncilofgovernments],
[ishousingauthoritiespublicortribal]=S.[ishousingauthoritiespublicortribal],
[isinterstateentity]=S.[isinterstateentity],
[isplanningcommission]=S.[isplanningcommission],
[isportauthority]=S.[isportauthority],
[istransitauthority]=S.[istransitauthority],
[issubchapterscorporation]=S.[issubchapterscorporation],
[islimitedliabilitycorporation]=S.[islimitedliabilitycorporation],
[isforeignownedandlocated]=S.[isforeignownedandlocated],
[isarchitectureandengineering]=coalesce(nullif(S.[isarchitectureandengineering],''),T.[isarchitectureandengineering]),
[isdotcertifieddisadvantagedbusinessenterprise]=S.[isdotcertifieddisadvantagedbusinessenterprise],
[iscitylocalgovernment]=S.[iscitylocalgovernment],
[iscommunitydevelopedcorporationownedfirm]=S.[iscommunitydevelopedcorporationownedfirm],
[iscommunitydevelopmentcorporation]=S.[iscommunitydevelopmentcorporation],
[isconstructionfirm]=coalesce(nullif(S.[isconstructionfirm],''),T.[isconstructionfirm]),
[ismanufacturerofgoods]=S.[ismanufacturerofgoods],
[iscorporateentitynottaxexempt]=S.[iscorporateentitynottaxexempt],
[iscountylocalgovernment]=S.[iscountylocalgovernment],
[isdomesticshelter]=S.[isdomesticshelter],
[isfederalgovernmentagency]=S.[isfederalgovernmentagency],
[isfederallyfundedresearchanddevelopmentcorp]=S.[isfederallyfundedresearchanddevelopmentcorp],
[isforeigngovernment]=S.[isforeigngovernment],
[isindiantribe]=S.[isindiantribe],
[isintermunicipallocalgovernment]=S.[isintermunicipallocalgovernment],
[isinternationalorganization]=S.[isinternationalorganization],
[islaborsurplusareafirm]=S.[islaborsurplusareafirm],
[islocalgovernmentowned]=S.[islocalgovernmentowned],
[ismunicipalitylocalgovernment]=S.[ismunicipalitylocalgovernment],
[isnativehawaiianownedorganizationorfirm]=S.[isnativehawaiianownedorganizationorfirm],
[isotherbusinessororganization]=coalesce(nullif(S.[isotherbusinessororganization],''),T.[isotherbusinessororganization]),
[isotherminorityowned]=S.[isotherminorityowned],
[ispartnershiporlimitedliabilitypartnership]=S.[ispartnershiporlimitedliabilitypartnership],
[isschooldistrictlocalgovernment]=S.[isschooldistrictlocalgovernment],
[issmallagriculturalcooperative]=S.[issmallagriculturalcooperative],
[issoleproprietorship]=S.[issoleproprietorship],
[istownshiplocalgovernment]=S.[istownshiplocalgovernment],
[istriballyownedfirm]=S.[istriballyownedfirm],
[istribalcollege]=S.[istribalcollege],
[isalaskannativeownedcorporationorfirm]=S.[isalaskannativeownedcorporationorfirm],
[iscorporateentitytaxexempt]=S.[iscorporateentitytaxexempt],
[iswomenownedsmallbusiness]=coalesce(nullif(S.[iswomenownedsmallbusiness],''),T.[iswomenownedsmallbusiness]),
[isecondisadvwomenownedsmallbusiness]=coalesce(nullif(S.[isecondisadvwomenownedsmallbusiness],''),T.[isecondisadvwomenownedsmallbusiness]),
[isjointventurewomenownedsmallbusiness]=coalesce(nullif(S.[isjointventurewomenownedsmallbusiness],''),T.[isjointventurewomenownedsmallbusiness]),
[isjointventureecondisadvwomenownedsmallbusiness]=coalesce(nullif(S.[isjointventureecondisadvwomenownedsmallbusiness],''),T.[isjointventureecondisadvwomenownedsmallbusiness]),
[walshhealyact]=S.[walshhealyact],
[servicecontractact]=S.[servicecontractact],
[davisbaconact]=S.[davisbaconact],
[clingercohenact]=S.[clingercohenact],
[otherstatutoryauthority]=S.[otherstatutoryauthority],
[interagencycontractingauthority]=S.[interagencycontractingauthority],
[CSISModifiedDate]=S.[CSISModifiedDate],
[PlaceofPerformanceCity]=S.[PlaceofPerformanceCity],
[prime_awardee_executive5]=coalesce(nullif(S.[prime_awardee_executive5],''),T.[prime_awardee_executive5]),
[prime_awardee_executive5_compensation]=S.[prime_awardee_executive5_compensation],
[last_modified_date]=S.[last_modified_date],
[prime_awardee_executive4]=coalesce(nullif(S.[prime_awardee_executive4],''),T.[prime_awardee_executive4]),
[prime_awardee_executive4_compensation]=S.[prime_awardee_executive4_compensation],
[prime_awardee_executive3]=coalesce(nullif(S.[prime_awardee_executive3],''),T.[prime_awardee_executive3]),
[prime_awardee_executive3_compensation]=S.[prime_awardee_executive3_compensation],
[prime_awardee_executive2]=coalesce(nullif(S.[prime_awardee_executive2],''),T.[prime_awardee_executive2]),
[prime_awardee_executive2_compensation]=S.[prime_awardee_executive2_compensation],
[prime_awardee_executive1]=coalesce(nullif(S.[prime_awardee_executive1],''),T.[prime_awardee_executive1]),
[prime_awardee_executive1_compensation]=S.[prime_awardee_executive1_compensation]
FROM Contract.FPDS as T
INNER Join ErrorLogging.FPDSviolatesConstraint as S
ON s.Unique_Transaction_ID=t.Unique_Transaction_ID and
s.Fiscal_Year=t.Fiscal_Year
WHERE s.last_modified_date>=t.last_modified_date
