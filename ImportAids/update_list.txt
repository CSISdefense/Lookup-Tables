UPDATE T SET
[last_modified_date]=coalesce(nullif(S.[last_modified_date],''),T.[last_modified_date]),
[piid]=coalesce(nullif(S.[piid],''),T.[piid]),
[modnumber]=coalesce(nullif(S.[modnumber],''),T.[modnumber]),
[transactionnumber]=coalesce(nullif(S.[transactionnumber],''),T.[transactionnumber]),
[idvagencyid]=coalesce(nullif(S.[idvagencyid],''),T.[idvagencyid]),
[idvpiid]=coalesce(nullif(S.[idvpiid],''),T.[idvpiid]),
[idvmodificationnumber]=coalesce(nullif(S.[idvmodificationnumber],''),T.[idvmodificationnumber]),
[obligatedamount]=coalesce(nullif(S.[obligatedamount],''),T.[obligatedamount]),
[baseandexercisedoptionsvalue]=coalesce(nullif(S.[baseandexercisedoptionsvalue],''),T.[baseandexercisedoptionsvalue]),
[baseandalloptionsvalue]=coalesce(nullif(S.[baseandalloptionsvalue],''),T.[baseandalloptionsvalue]),
[signeddate]=coalesce(nullif(S.[signeddate],''),T.[signeddate]),
[effectivedate]=coalesce(nullif(S.[effectivedate],''),T.[effectivedate]),
[currentcompletiondate]=coalesce(nullif(S.[currentcompletiondate],''),T.[currentcompletiondate]),
[ultimatecompletiondate]=coalesce(nullif(S.[ultimatecompletiondate],''),T.[ultimatecompletiondate]),
[lastdatetoorder]=coalesce(nullif(S.[lastdatetoorder],''),T.[lastdatetoorder]),
[agencyid]=coalesce(nullif(S.[agencyid],''),T.[agencyid]),
[contractingofficeagencyid]=coalesce(nullif(S.[contractingofficeagencyid],''),T.[contractingofficeagencyid]),
[contractingofficeid]=coalesce(nullif(S.[contractingofficeid],''),T.[contractingofficeid]),
[maj_fund_agency_cat]=coalesce(nullif(S.[maj_fund_agency_cat],''),T.[maj_fund_agency_cat]),
[fundingrequestingagencyid]=coalesce(nullif(S.[fundingrequestingagencyid],''),T.[fundingrequestingagencyid]),
[fundingrequestingofficeid]=coalesce(nullif(S.[fundingrequestingofficeid],''),T.[fundingrequestingofficeid]),
[fundedbyforeignentity]=coalesce(nullif(S.[fundedbyforeignentity],''),T.[fundedbyforeignentity]),
[ccrexception]=coalesce(nullif(S.[ccrexception],''),T.[ccrexception]),
[dunsnumber]=coalesce(nullif(S.[dunsnumber],''),T.[dunsnumber]),
[vendorname]=coalesce(nullif(S.[vendorname],''),T.[vendorname]),
[vendordoingasbusinessname]=coalesce(nullif(S.[vendordoingasbusinessname],''),T.[vendordoingasbusinessname]),
[mod_parent]=coalesce(nullif(S.[mod_parent],''),T.[mod_parent]),
[parentdunsnumber]=coalesce(nullif(S.[parentdunsnumber],''),T.[parentdunsnumber]),
[vendorcountrycode]=coalesce(nullif(S.[vendorcountrycode],''),T.[vendorcountrycode]),
[streetaddress]=coalesce(nullif(S.[streetaddress],''),T.[streetaddress]),
[streetaddress2]=coalesce(nullif(S.[streetaddress2],''),T.[streetaddress2]),
[streetaddress3]=coalesce(nullif(S.[streetaddress3],''),T.[streetaddress3]),
[city]=coalesce(nullif(S.[city],''),T.[city]),
[vendor_state_code]=coalesce(nullif(S.[vendor_state_code],''),T.[vendor_state_code]),
[zipcode]=coalesce(nullif(S.[zipcode],''),T.[zipcode]),
[vendor_cd]=coalesce(nullif(S.[vendor_cd],''),T.[vendor_cd]),
[phoneno]=coalesce(nullif(S.[phoneno],''),T.[phoneno]),
[faxno]=coalesce(nullif(S.[faxno],''),T.[faxno]),
[placeofperformancecountrycode]=coalesce(nullif(S.[placeofperformancecountrycode],''),T.[placeofperformancecountrycode]),
[PlaceofPerformanceCity]=coalesce(nullif(S.[PlaceofPerformanceCity],''),T.[PlaceofPerformanceCity]),
[primary_place_of_performance_county_name]=coalesce(nullif(S.[primary_place_of_performance_county_name],''),T.[primary_place_of_performance_county_name]),
[pop_state_code]=coalesce(nullif(S.[pop_state_code],''),T.[pop_state_code]),
[placeofperformancezipcode]=coalesce(nullif(S.[placeofperformancezipcode],''),T.[placeofperformancezipcode]),
[placeofperformancecongressionaldistrict]=coalesce(nullif(S.[placeofperformancecongressionaldistrict],''),T.[placeofperformancecongressionaldistrict]),
[locationcode]=coalesce(nullif(S.[locationcode],''),T.[locationcode]),
[award_type_code]=coalesce(nullif(S.[award_type_code],''),T.[award_type_code]),
[idv_type_code]=coalesce(nullif(S.[idv_type_code],''),T.[idv_type_code]),
[multipleorsingleawardidc]=coalesce(nullif(S.[multipleorsingleawardidc],''),T.[multipleorsingleawardidc]),
[typeofidc]=coalesce(nullif(S.[typeofidc],''),T.[typeofidc]),
[typeofcontractpricing]=coalesce(nullif(S.[typeofcontractpricing],''),T.[typeofcontractpricing]),
[descriptionofcontractrequirement]=coalesce(nullif(S.[descriptionofcontractrequirement],''),T.[descriptionofcontractrequirement]),
[reasonformodification]=coalesce(nullif(S.[reasonformodification],''),T.[reasonformodification]),
[solicitationid]=coalesce(nullif(S.[solicitationid],''),T.[solicitationid]),
[numberofactions]=coalesce(nullif(S.[numberofactions],''),T.[numberofactions]),
[productorservicecode]=coalesce(nullif(S.[productorservicecode],''),T.[productorservicecode]),
[contractbundling]=coalesce(nullif(S.[contractbundling],''),T.[contractbundling]),
[claimantprogramcode]=coalesce(nullif(S.[claimantprogramcode],''),T.[claimantprogramcode]),
[principalnaicscode]=coalesce(nullif(S.[principalnaicscode],''),T.[principalnaicscode]),
[recoveredmaterialclauses]=coalesce(nullif(S.[recoveredmaterialclauses],''),T.[recoveredmaterialclauses]),
[manufacturingorganizationtype]=coalesce(nullif(S.[manufacturingorganizationtype],''),T.[manufacturingorganizationtype]),
[systemequipmentcode]=coalesce(nullif(S.[systemequipmentcode],''),T.[systemequipmentcode]),
[informationtechnologycommercialitemcategory]=coalesce(nullif(S.[informationtechnologycommercialitemcategory],''),T.[informationtechnologycommercialitemcategory]),
[useofepadesignatedproducts]=coalesce(nullif(S.[useofepadesignatedproducts],''),T.[useofepadesignatedproducts]),
[countryoforigin]=coalesce(nullif(S.[countryoforigin],''),T.[countryoforigin]),
[placeofmanufacture]=coalesce(nullif(S.[placeofmanufacture],''),T.[placeofmanufacture]),
[subcontractplan]=coalesce(nullif(S.[subcontractplan],''),T.[subcontractplan]),
[extentcompeted]=coalesce(nullif(S.[extentcompeted],''),T.[extentcompeted]),
[solicitationprocedures]=coalesce(nullif(S.[solicitationprocedures],''),T.[solicitationprocedures]),
[typeofsetaside]=coalesce(nullif(S.[typeofsetaside],''),T.[typeofsetaside]),
[evaluatedpreference]=coalesce(nullif(S.[evaluatedpreference],''),T.[evaluatedpreference]),
[research_code]=coalesce(nullif(S.[research_code],''),T.[research_code]),
[statutoryexceptiontofairopportunity]=coalesce(nullif(S.[statutoryexceptiontofairopportunity],''),T.[statutoryexceptiontofairopportunity]),
[reasonnotcompeted]=coalesce(nullif(S.[reasonnotcompeted],''),T.[reasonnotcompeted]),
[numberofoffersreceived]=coalesce(nullif(S.[numberofoffersreceived],''),T.[numberofoffersreceived]),
[commercialitemacquisitionprocedures]=coalesce(nullif(S.[commercialitemacquisitionprocedures],''),T.[commercialitemacquisitionprocedures]),
[smallbusinesscompetitivenessdemonstrationprogram]=coalesce(nullif(S.[smallbusinesscompetitivenessdemonstrationprogram],''),T.[smallbusinesscompetitivenessdemonstrationprogram]),
[commercialitemtestprogram]=coalesce(nullif(S.[commercialitemtestprogram],''),T.[commercialitemtestprogram]),
[a76action]=coalesce(nullif(S.[a76action],''),T.[a76action]),
[fedbizopps]=coalesce(nullif(S.[fedbizopps],''),T.[fedbizopps]),
[localareasetaside]=coalesce(nullif(S.[localareasetaside],''),T.[localareasetaside]),
[priceevaluationpercentdifference]=coalesce(nullif(S.[priceevaluationpercentdifference],''),T.[priceevaluationpercentdifference]),
[clingercohenact]=coalesce(nullif(S.[clingercohenact],''),T.[clingercohenact]),
[walshhealyact]=coalesce(nullif(S.[walshhealyact],''),T.[walshhealyact]),
[servicecontractact]=coalesce(nullif(S.[servicecontractact],''),T.[servicecontractact]),
[davisbaconact]=coalesce(nullif(S.[davisbaconact],''),T.[davisbaconact]),
[interagencycontractingauthority]=coalesce(nullif(S.[interagencycontractingauthority],''),T.[interagencycontractingauthority]),
[otherstatutoryauthority]=coalesce(nullif(S.[otherstatutoryauthority],''),T.[otherstatutoryauthority]),
[programacronym]=coalesce(nullif(S.[programacronym],''),T.[programacronym]),
[parent_award_type_code]=coalesce(nullif(S.[parent_award_type_code],''),T.[parent_award_type_code]),
[parent_award_single_or_multiple_code]=coalesce(nullif(S.[parent_award_single_or_multiple_code],''),T.[parent_award_single_or_multiple_code]),
[majorprogramcode]=coalesce(nullif(S.[majorprogramcode],''),T.[majorprogramcode]),
[nationalinterestactioncode]=coalesce(nullif(S.[nationalinterestactioncode],''),T.[nationalinterestactioncode]),
[costorpricingdata]=coalesce(nullif(S.[costorpricingdata],''),T.[costorpricingdata]),
[costaccountingstandardsclause]=coalesce(nullif(S.[costaccountingstandardsclause],''),T.[costaccountingstandardsclause]),
[gfe_gfp_code]=coalesce(nullif(S.[gfe_gfp_code],''),T.[gfe_gfp_code]),
[seatransportation]=coalesce(nullif(S.[seatransportation],''),T.[seatransportation]),
[lettercontract]=coalesce(nullif(S.[lettercontract],''),T.[lettercontract]),
[consolidatedcontract]=coalesce(nullif(S.[consolidatedcontract],''),T.[consolidatedcontract]),
[performancebasedservicecontract]=coalesce(nullif(S.[performancebasedservicecontract],''),T.[performancebasedservicecontract]),
[multiyearcontract]=coalesce(nullif(S.[multiyearcontract],''),T.[multiyearcontract]),
[contractfinancing]=coalesce(nullif(S.[contractfinancing],''),T.[contractfinancing]),
[purchasecardaspaymentmethod]=coalesce(nullif(S.[purchasecardaspaymentmethod],''),T.[purchasecardaspaymentmethod]),
[contingencyhumanitarianpeacekeepingoperation]=coalesce(nullif(S.[contingencyhumanitarianpeacekeepingoperation],''),T.[contingencyhumanitarianpeacekeepingoperation]),
[isalaskannativeownedcorporationorfirm]=coalesce(nullif(S.[isalaskannativeownedcorporationorfirm],''),T.[isalaskannativeownedcorporationorfirm]),
[aiobflag]=coalesce(nullif(S.[aiobflag],''),T.[aiobflag]),
[indian_tribe_federally_recognized]=coalesce(nullif(S.[indian_tribe_federally_recognized],''),T.[indian_tribe_federally_recognized]),
[isnativehawaiianownedorganizationorfirm]=coalesce(nullif(S.[isnativehawaiianownedorganizationorfirm],''),T.[isnativehawaiianownedorganizationorfirm]),
[istriballyownedfirm]=coalesce(nullif(S.[istriballyownedfirm],''),T.[istriballyownedfirm]),
[veteranownedflag]=coalesce(nullif(S.[veteranownedflag],''),T.[veteranownedflag]),
[srdvobflag]=coalesce(nullif(S.[srdvobflag],''),T.[srdvobflag]),
[womenownedflag]=coalesce(nullif(S.[womenownedflag],''),T.[womenownedflag]),
[iswomenownedsmallbusiness]=coalesce(nullif(S.[iswomenownedsmallbusiness],''),T.[iswomenownedsmallbusiness]),
[isecondisadvwomenownedsmallbusiness]=coalesce(nullif(S.[isecondisadvwomenownedsmallbusiness],''),T.[isecondisadvwomenownedsmallbusiness]),
[isjointventurewomenownedsmallbusiness]=coalesce(nullif(S.[isjointventurewomenownedsmallbusiness],''),T.[isjointventurewomenownedsmallbusiness]),
[isjointventureecondisadvwomenownedsmallbusiness]=coalesce(nullif(S.[isjointventureecondisadvwomenownedsmallbusiness],''),T.[isjointventureecondisadvwomenownedsmallbusiness]),
[minorityownedbusinessflag]=coalesce(nullif(S.[minorityownedbusinessflag],''),T.[minorityownedbusinessflag]),
[saaobflag]=coalesce(nullif(S.[saaobflag],''),T.[saaobflag]),
[apaobflag]=coalesce(nullif(S.[apaobflag],''),T.[apaobflag]),
[baobflag]=coalesce(nullif(S.[baobflag],''),T.[baobflag]),
[haobflag]=coalesce(nullif(S.[haobflag],''),T.[haobflag]),
[naobflag]=coalesce(nullif(S.[naobflag],''),T.[naobflag]),
[other_minority_owned_business]=coalesce(nullif(S.[other_minority_owned_business],''),T.[other_minority_owned_business]),
[contractingofficerbusinesssizedetermination]=coalesce(nullif(S.[contractingofficerbusinesssizedetermination],''),T.[contractingofficerbusinesssizedetermination]),
[emergingsmallbusinessflag]=coalesce(nullif(S.[emergingsmallbusinessflag],''),T.[emergingsmallbusinessflag]),
[community_developed_corporation_owned_firm]=coalesce(nullif(S.[community_developed_corporation_owned_firm],''),T.[community_developed_corporation_owned_firm]),
[labor_surplus_area_firm]=coalesce(nullif(S.[labor_surplus_area_firm],''),T.[labor_surplus_area_firm]),
[federalgovernmentflag]=coalesce(nullif(S.[federalgovernmentflag],''),T.[federalgovernmentflag]),
[isfederallyfundedresearchanddevelopmentcorp]=coalesce(nullif(S.[isfederallyfundedresearchanddevelopmentcorp],''),T.[isfederallyfundedresearchanddevelopmentcorp]),
[isfederalgovernmentagency]=coalesce(nullif(S.[isfederalgovernmentagency],''),T.[isfederalgovernmentagency]),
[stategovernmentflag]=coalesce(nullif(S.[stategovernmentflag],''),T.[stategovernmentflag]),
[localgovernmentflag]=coalesce(nullif(S.[localgovernmentflag],''),T.[localgovernmentflag]),
[city_local_government]=coalesce(nullif(S.[city_local_government],''),T.[city_local_government]),
[county_local_government]=coalesce(nullif(S.[county_local_government],''),T.[county_local_government]),
[inter_municipal_local_government]=coalesce(nullif(S.[inter_municipal_local_government],''),T.[inter_municipal_local_government]),
[local_government_owned]=coalesce(nullif(S.[local_government_owned],''),T.[local_government_owned]),
[ismunicipalitylocalgovernment]=coalesce(nullif(S.[ismunicipalitylocalgovernment],''),T.[ismunicipalitylocalgovernment]),
[isschooldistrictlocalgovernment]=coalesce(nullif(S.[isschooldistrictlocalgovernment],''),T.[isschooldistrictlocalgovernment]),
[istownshiplocalgovernment]=coalesce(nullif(S.[istownshiplocalgovernment],''),T.[istownshiplocalgovernment]),
[tribalgovernmentflag]=coalesce(nullif(S.[tribalgovernmentflag],''),T.[tribalgovernmentflag]),
[isforeigngovernment]=coalesce(nullif(S.[isforeigngovernment],''),T.[isforeigngovernment]),
[corporate_entity_not_tax_exempt]=coalesce(nullif(S.[corporate_entity_not_tax_exempt],''),T.[corporate_entity_not_tax_exempt]),
[iscorporateentitytaxexempt]=coalesce(nullif(S.[iscorporateentitytaxexempt],''),T.[iscorporateentitytaxexempt]),
[ispartnershiporlimitedliabilitypartnership]=coalesce(nullif(S.[ispartnershiporlimitedliabilitypartnership],''),T.[ispartnershiporlimitedliabilitypartnership]),
[issoleproprietorship]=coalesce(nullif(S.[issoleproprietorship],''),T.[issoleproprietorship]),
[issmallagriculturalcooperative]=coalesce(nullif(S.[issmallagriculturalcooperative],''),T.[issmallagriculturalcooperative]),
[international_organization]=coalesce(nullif(S.[international_organization],''),T.[international_organization]),
[us_government_entity]=coalesce(nullif(S.[us_government_entity],''),T.[us_government_entity]),
[community_development_corporation]=coalesce(nullif(S.[community_development_corporation],''),T.[community_development_corporation]),
[domestic_shelter]=coalesce(nullif(S.[domestic_shelter],''),T.[domestic_shelter]),
[educationalinstitutionflag]=coalesce(nullif(S.[educationalinstitutionflag],''),T.[educationalinstitutionflag]),
[isfoundation]=coalesce(nullif(S.[isfoundation],''),T.[isfoundation]),
[hospitalflag]=coalesce(nullif(S.[hospitalflag],''),T.[hospitalflag]),
[manufacturer_of_goods]=coalesce(nullif(S.[manufacturer_of_goods],''),T.[manufacturer_of_goods]),
[isveterinaryhospital]=coalesce(nullif(S.[isveterinaryhospital],''),T.[isveterinaryhospital]),
[ishispanicservicinginstitution]=coalesce(nullif(S.[ishispanicservicinginstitution],''),T.[ishispanicservicinginstitution]),
[receivescontracts]=coalesce(nullif(S.[receivescontracts],''),T.[receivescontracts]),
[receivesgrants]=coalesce(nullif(S.[receivesgrants],''),T.[receivesgrants]),
[receivescontractsandgrants]=coalesce(nullif(S.[receivescontractsandgrants],''),T.[receivescontractsandgrants]),
[isairportauthority]=coalesce(nullif(S.[isairportauthority],''),T.[isairportauthority]),
[iscouncilofgovernments]=coalesce(nullif(S.[iscouncilofgovernments],''),T.[iscouncilofgovernments]),
[ishousingauthoritiespublicortribal]=coalesce(nullif(S.[ishousingauthoritiespublicortribal],''),T.[ishousingauthoritiespublicortribal]),
[isinterstateentity]=coalesce(nullif(S.[isinterstateentity],''),T.[isinterstateentity]),
[isplanningcommission]=coalesce(nullif(S.[isplanningcommission],''),T.[isplanningcommission]),
[isportauthority]=coalesce(nullif(S.[isportauthority],''),T.[isportauthority]),
[istransitauthority]=coalesce(nullif(S.[istransitauthority],''),T.[istransitauthority]),
[issubchapterscorporation]=coalesce(nullif(S.[issubchapterscorporation],''),T.[issubchapterscorporation]),
[islimitedliabilitycorporation]=coalesce(nullif(S.[islimitedliabilitycorporation],''),T.[islimitedliabilitycorporation]),
[isforeignownedandlocated]=coalesce(nullif(S.[isforeignownedandlocated],''),T.[isforeignownedandlocated]),
[isforprofitorganization]=coalesce(nullif(S.[isforprofitorganization],''),T.[isforprofitorganization]),
[nonprofitorganizationflag]=coalesce(nullif(S.[nonprofitorganizationflag],''),T.[nonprofitorganizationflag]),
[isothernotforprofitorganization]=coalesce(nullif(S.[isothernotforprofitorganization],''),T.[isothernotforprofitorganization]),
[shelteredworkshopflag]=coalesce(nullif(S.[shelteredworkshopflag],''),T.[shelteredworkshopflag]),
[isprivateuniversityorcollege]=coalesce(nullif(S.[isprivateuniversityorcollege],''),T.[isprivateuniversityorcollege]),
[isstatecontrolledinstitutionofhigherlearning]=coalesce(nullif(S.[isstatecontrolledinstitutionofhigherlearning],''),T.[isstatecontrolledinstitutionofhigherlearning]),
[is1862landgrantcollege]=coalesce(nullif(S.[is1862landgrantcollege],''),T.[is1862landgrantcollege]),
[is1890landgrantcollege]=coalesce(nullif(S.[is1890landgrantcollege],''),T.[is1890landgrantcollege]),
[is1994landgrantcollege]=coalesce(nullif(S.[is1994landgrantcollege],''),T.[is1994landgrantcollege]),
[minorityinstitutionflag]=coalesce(nullif(S.[minorityinstitutionflag],''),T.[minorityinstitutionflag]),
[hbcuflag]=coalesce(nullif(S.[hbcuflag],''),T.[hbcuflag]),
[istribalcollege]=coalesce(nullif(S.[istribalcollege],''),T.[istribalcollege]),
[alaskan_native_servicing_institution]=coalesce(nullif(S.[alaskan_native_servicing_institution],''),T.[alaskan_native_servicing_institution]),
[native_hawaiian_servicing_institution]=coalesce(nullif(S.[native_hawaiian_servicing_institution],''),T.[native_hawaiian_servicing_institution]),
[isschoolofforestry]=coalesce(nullif(S.[isschoolofforestry],''),T.[isschoolofforestry]),
[isveterinarycollege]=coalesce(nullif(S.[isveterinarycollege],''),T.[isveterinarycollege]),
[dot_certified_disadvantage]=coalesce(nullif(S.[dot_certified_disadvantage],''),T.[dot_certified_disadvantage]),
[sdbflag]=coalesce(nullif(S.[sdbflag],''),T.[sdbflag]),
[issbacertifiedsmalldisadvantagedbusiness]=coalesce(nullif(S.[issbacertifiedsmalldisadvantagedbusiness],''),T.[issbacertifiedsmalldisadvantagedbusiness]),
[firm8aflag]=coalesce(nullif(S.[firm8aflag],''),T.[firm8aflag]),
[hubzoneflag]=coalesce(nullif(S.[hubzoneflag],''),T.[hubzoneflag]),
[sba_certified_8a_joint_venture]=coalesce(nullif(S.[sba_certified_8a_joint_venture],''),T.[sba_certified_8a_joint_venture]),
[CSISModifiedDate]=coalesce(nullif(S.[CSISmodifiedDate],''),T.[CSISModifiedDate]),
[CSIStransactionID]=coalesce(nullif(S.[CSIStransactionID],''),T.[CSIStransactionID])
FROM Contract.FPDS as T
INNER Join ErrorLogging.FPDSviolatesConstraint as S
ON s.Unique_Transaction_ID=t.Unique_Transaction_ID and
s.Fiscal_Year=t.Fiscal_Year
WHERE s.last_modified_date>=t.last_modified_date
