UPDATE T SET
NA=S.[gfe_gfp_name],
NA=S.[research_name],
[last_modified_date]=S.[last_modified_date],
[piid]=S.[piid],
[modnumber]=S.[modnumber],
[transactionnumber]=S.[transactionnumber],
[idvagencyid]=S.[idvagencyid],
NA=S.[parent_award_agency_name],
[idvpiid]=S.[idvpiid],
[idvmodificationnumber]=S.[idvmodificationnumber],
[obligatedamount]=S.[obligatedamount],
[baseandexercisedoptionsvalue]=S.[baseandexercisedoptionsvalue],
[baseandalloptionsvalue]=S.[baseandalloptionsvalue],
[signeddate]=S.[signeddate],
[effectivedate]=S.[effectivedate],
[currentcompletiondate]=S.[currentcompletiondate],
[ultimatecompletiondate]=S.[ultimatecompletiondate],
[lastdatetoorder]=S.[lastdatetoorder],
[agencyid]=S.[agencyid],
NA=S.[awarding_agency_name],
[contractingofficeagencyid]=S.[contractingofficeagencyid],
NA=S.[awarding_sub_agency_name],
[contractingofficeid]=S.[contractingofficeid],
NA=S.[awarding_office_name],
[maj_fund_agency_cat]=S.[maj_fund_agency_cat],
NA=S.[funding_agency_name],
[fundingrequestingagencyid]=S.[fundingrequestingagencyid],
NA=S.[funding_sub_agency_name],
[fundingrequestingofficeid]=S.[fundingrequestingofficeid],
NA=S.[funding_office_name],
[fundedbyforeignentity]=S.[fundedbyforeignentity],
[ccrexception]=S.[ccrexception],
[dunsnumber]=S.[dunsnumber],
[vendorname]=S.[vendorname],
[vendordoingasbusinessname]=S.[vendordoingasbusinessname],
[mod_parent]=S.[mod_parent],
[parentdunsnumber]=coalesce(nullif(S.[parentdunsnumber],''),T.[parentdunsnumber]),
[vendorcountrycode]=S.[vendorcountrycode],
NA=S.[recipient_country_name],
[streetaddress]=S.[streetaddress],
[streetaddress2]=S.[streetaddress2],
[streetaddress3]=S.[streetaddress3],
[city]=S.[city],
[vendor_state_code]=S.[vendor_state_code],
NA=S.[recipient_state_name],
[zipcode]=S.[zipcode],
[vendor_cd]=S.[vendor_cd],
[phoneno]=S.[phoneno],
[faxno]=S.[faxno],
[placeofperformancecountrycode]=S.[placeofperformancecountrycode],
NA=S.[primary_place_of_performance_country_name],
[PlaceofPerformanceCity]=S.[PlaceofPerformanceCity],
[primary_place_of_performance_county_name]=S.[primary_place_of_performance_county_name],
[pop_state_code]=S.[pop_state_code],
NA=S.[primary_place_of_performance_state_name],
[placeofperformancezipcode]=S.[placeofperformancezipcode],
[placeofperformancecongressionaldistrict]=S.[placeofperformancecongressionaldistrict],
[locationcode]=coalesce(nullif(S.[locationcode],''),T.[locationcode]),
[award_type_code]=S.[award_type_code],
NA=S.[award_type_name],
[idv_type_code]=S.[idv_type_code],
NA=S.[idv_type_name],
[multipleorsingleawardidc]=S.[multipleorsingleawardidc],
NA=S.[multiple_or_single_award_idv_name],
[typeofidc]=S.[typeofidc],
NA=S.[type_of_idc_name],
[typeofcontractpricing]=S.[typeofcontractpricing],
NA=S.[type_of_contract_pricing_name],
[descriptionofcontractrequirement]=S.[descriptionofcontractrequirement],
[reasonformodification]=S.[reasonformodification],
NA=S.[action_type_name],
[solicitationid]=S.[solicitationid],
[numberofactions]=S.[numberofactions],
[productorservicecode]=S.[productorservicecode],
NA=S.[product_or_service_code_description],
[contractbundling]=S.[contractbundling],
NA=S.[contract_bundling_name],
[claimantprogramcode]=S.[claimantprogramcode],
NA=S.[dod_claimant_program_description],
[principalnaicscode]=S.[principalnaicscode],
NA=S.[naics_description],
[recoveredmaterialclauses]=S.[recoveredmaterialclauses],
NA=S.[recovered_materials_sustainability_name],
[manufacturingorganizationtype]=S.[manufacturingorganizationtype],
NA=S.[domestic_or_foreign_entity_name],
[systemequipmentcode]=S.[systemequipmentcode],
NA=S.[dod_acquisition_program_description],
[informationtechnologycommercialitemcategory]=S.[informationtechnologycommercialitemcategory],
NA=S.[information_technology_commercial_item_category_name],
[useofepadesignatedproducts]=S.[useofepadesignatedproducts],
NA=S.[epa_designated_product_name],
[countryoforigin]=S.[countryoforigin],
NA=S.[country_of_product_or_service_origin_name],
[placeofmanufacture]=S.[placeofmanufacture],
NA=S.[place_of_manufacture_name],
[subcontractplan]=S.[subcontractplan],
NA=S.[subcontracting_plan_name],
[extentcompeted]=S.[extentcompeted],
NA=S.[extent_competed_name],
[solicitationprocedures]=S.[solicitationprocedures],
NA=S.[solicitation_procedures_name],
[typeofsetaside]=S.[typeofsetaside],
NA=S.[type_of_set_aside_name],
[evaluatedpreference]=S.[evaluatedpreference],
NA=S.[evaluated_preference_name],
[research_code]=S.[research_code],
[statutoryexceptiontofairopportunity]=S.[statutoryexceptiontofairopportunity],
NA=S.[fair_opportunity_limited_sources_name],
[reasonnotcompeted]=S.[reasonnotcompeted],
NA=S.[other_than_full_and_open_competition_name],
[numberofoffersreceived]=S.[numberofoffersreceived],
[commercialitemacquisitionprocedures]=S.[commercialitemacquisitionprocedures],
NA=S.[commercial_item_acquisition_procedures_name],
[smallbusinesscompetitivenessdemonstrationprogram]=coalesce(nullif(S.[smallbusinesscompetitivenessdemonstrationprogram],''),T.[smallbusinesscompetitivenessdemonstrationprogram]),
[commercialitemtestprogram]=S.[commercialitemtestprogram],
NA=S.[commercial_item_test_program_name],
[a76action]=S.[a76action],
NA=S.[a76_fair_act_action_name],
[fedbizopps]=S.[fedbizopps],
NA=S.[fed_biz_opps_name],
[localareasetaside]=S.[localareasetaside],
NA=S.[local_area_set_aside_name],
[priceevaluationpercentdifference]=S.[priceevaluationpercentdifference],
[clingercohenact]=S.[clingercohenact],
NA=S.[clinger_cohen_act_planning_name],
[walshhealyact]=S.[walshhealyact],
NA=S.[walsh_healey_act_name],
[servicecontractact]=S.[servicecontractact],
NA=S.[service_contract_act_name],
[davisbaconact]=S.[davisbaconact],
NA=S.[davis_bacon_act_name],
[interagencycontractingauthority]=S.[interagencycontractingauthority],
NA=S.[interagency_contracting_authority_name],
[otherstatutoryauthority]=S.[otherstatutoryauthority],
[programacronym]=S.[programacronym],
[parent_award_type_code]=S.[parent_award_type_code],
NA=S.[parent_award_type_name],
[parent_award_single_or_multiple_code]=S.[parent_award_single_or_multiple_code],
NA=S.[parent_award_single_or_multiple_name],
[majorprogramcode]=coalesce(nullif(S.[majorprogramcode],''),T.[majorprogramcode]),
[nationalinterestactioncode]=S.[nationalinterestactioncode],
NA=S.[national_interest_action_name],
[costorpricingdata]=S.[costorpricingdata],
NA=S.[cost_or_pricing_data_name],
[costaccountingstandardsclause]=S.[costaccountingstandardsclause],
NA=S.[cost_accounting_standards_clause_name],
[gfe_gfp_code]=S.[gfe_gfp_code],
[seatransportation]=S.[seatransportation],
NA=S.[sea_transportation_name],
[lettercontract]=coalesce(nullif(S.[lettercontract],''),T.[lettercontract]),
NA=S.[undefinitized_action_name],
[consolidatedcontract]=S.[consolidatedcontract],
NA=S.[consolidated_contract_name],
[performancebasedservicecontract]=S.[performancebasedservicecontract],
NA=S.[performance_based_service_acquisition_name],
[multiyearcontract]=S.[multiyearcontract],
NA=S.[multi_year_contract_name],
[contractfinancing]=S.[contractfinancing],
NA=S.[contract_financing_name],
[purchasecardaspaymentmethod]=S.[purchasecardaspaymentmethod],
NA=S.[purchase_card_as_payment_method_name],
[contingencyhumanitarianpeacekeepingoperation]=S.[contingencyhumanitarianpeacekeepingoperation],
NA=S.[contingency_humanitarian_or_peacekeeping_operation_name],
[isalaskannativeownedcorporationorfirm]=S.[isalaskannativeownedcorporationorfirm],
[aiobflag]=S.[aiobflag],
[indian_tribe_federally_recognized]=S.[indian_tribe_federally_recognized],
[isnativehawaiianownedorganizationorfirm]=S.[isnativehawaiianownedorganizationorfirm],
[istriballyownedfirm]=S.[istriballyownedfirm],
[veteranownedflag]=S.[veteranownedflag],
[srdvobflag]=S.[srdvobflag],
[womenownedflag]=S.[womenownedflag],
[iswomenownedsmallbusiness]=coalesce(nullif(S.[iswomenownedsmallbusiness],''),T.[iswomenownedsmallbusiness]),
[isecondisadvwomenownedsmallbusiness]=coalesce(nullif(S.[isecondisadvwomenownedsmallbusiness],''),T.[isecondisadvwomenownedsmallbusiness]),
[isjointventurewomenownedsmallbusiness]=coalesce(nullif(S.[isjointventurewomenownedsmallbusiness],''),T.[isjointventurewomenownedsmallbusiness]),
[isjointventureecondisadvwomenownedsmallbusiness]=coalesce(nullif(S.[isjointventureecondisadvwomenownedsmallbusiness],''),T.[isjointventureecondisadvwomenownedsmallbusiness]),
[minorityownedbusinessflag]=S.[minorityownedbusinessflag],
[saaobflag]=S.[saaobflag],
[apaobflag]=S.[apaobflag],
[baobflag]=S.[baobflag],
[haobflag]=S.[haobflag],
[naobflag]=S.[naobflag],
[other_minority_owned_business]=S.[other_minority_owned_business],
NA=S.[contracting_officers_determination_of_business_size_code_name],
[contractingofficerbusinesssizedetermination]=S.[contractingofficerbusinesssizedetermination],
[emergingsmallbusinessflag]=S.[emergingsmallbusinessflag],
[community_developed_corporation_owned_firm]=S.[community_developed_corporation_owned_firm],
[labor_surplus_area_firm]=S.[labor_surplus_area_firm],
[federalgovernmentflag]=S.[federalgovernmentflag],
[isfederallyfundedresearchanddevelopmentcorp]=S.[isfederallyfundedresearchanddevelopmentcorp],
[isfederalgovernmentagency]=S.[isfederalgovernmentagency],
[stategovernmentflag]=S.[stategovernmentflag],
[localgovernmentflag]=S.[localgovernmentflag],
[city_local_government]=S.[city_local_government],
[county_local_government]=S.[county_local_government],
[inter_municipal_local_government]=S.[inter_municipal_local_government],
[local_government_owned]=S.[local_government_owned],
[ismunicipalitylocalgovernment]=S.[ismunicipalitylocalgovernment],
[isschooldistrictlocalgovernment]=S.[isschooldistrictlocalgovernment],
[istownshiplocalgovernment]=S.[istownshiplocalgovernment],
[tribalgovernmentflag]=S.[tribalgovernmentflag],
[isforeigngovernment]=S.[isforeigngovernment],
[corporate_entity_not_tax_exempt]=S.[corporate_entity_not_tax_exempt],
[iscorporateentitytaxexempt]=S.[iscorporateentitytaxexempt],
[ispartnershiporlimitedliabilitypartnership]=S.[ispartnershiporlimitedliabilitypartnership],
[issoleproprietorship]=S.[issoleproprietorship],
[issmallagriculturalcooperative]=S.[issmallagriculturalcooperative],
[international_organization]=S.[international_organization],
[us_government_entity]=S.[us_government_entity],
[community_development_corporation]=S.[community_development_corporation],
[domestic_shelter]=S.[domestic_shelter],
[educationalinstitutionflag]=S.[educationalinstitutionflag],
[isfoundation]=S.[isfoundation],
[hospitalflag]=S.[hospitalflag],
[manufacturer_of_goods]=S.[manufacturer_of_goods],
[isveterinaryhospital]=S.[isveterinaryhospital],
[ishispanicservicinginstitution]=S.[ishispanicservicinginstitution],
[receivescontracts]=S.[receivescontracts],
[receivesgrants]=S.[receivesgrants],
[receivescontractsandgrants]=S.[receivescontractsandgrants],
[isairportauthority]=S.[isairportauthority],
[iscouncilofgovernments]=S.[iscouncilofgovernments],
[ishousingauthoritiespublicortribal]=S.[ishousingauthoritiespublicortribal],
[isinterstateentity]=S.[isinterstateentity],
[isplanningcommission]=S.[isplanningcommission],
[isportauthority]=S.[isportauthority],
[istransitauthority]=S.[istransitauthority],
[issubchapterscorporation]=S.[issubchapterscorporation],
[islimitedliabilitycorporation]=S.[islimitedliabilitycorporation],
[isforeignownedandlocated]=S.[isforeignownedandlocated],
[isforprofitorganization]=S.[isforprofitorganization],
[nonprofitorganizationflag]=S.[nonprofitorganizationflag],
[isothernotforprofitorganization]=S.[isothernotforprofitorganization],
[shelteredworkshopflag]=S.[shelteredworkshopflag],
[isprivateuniversityorcollege]=S.[isprivateuniversityorcollege],
[isstatecontrolledinstitutionofhigherlearning]=S.[isstatecontrolledinstitutionofhigherlearning],
[is1862landgrantcollege]=S.[is1862landgrantcollege],
[is1890landgrantcollege]=S.[is1890landgrantcollege],
[is1994landgrantcollege]=S.[is1994landgrantcollege],
[minorityinstitutionflag]=S.[minorityinstitutionflag],
[hbcuflag]=S.[hbcuflag],
[istribalcollege]=S.[istribalcollege],
[alaskan_native_servicing_institution]=S.[alaskan_native_servicing_institution],
[native_hawaiian_servicing_institution]=S.[native_hawaiian_servicing_institution],
[isschoolofforestry]=S.[isschoolofforestry],
[isveterinarycollege]=S.[isveterinarycollege],
[dot_certified_disadvantage]=S.[dot_certified_disadvantage],
[sdbflag]=S.[sdbflag],
[issbacertifiedsmalldisadvantagedbusiness]=S.[issbacertifiedsmalldisadvantagedbusiness],
[firm8aflag]=S.[firm8aflag],
[hubzoneflag]=S.[hubzoneflag],
[sba_certified_8a_joint_venture]=S.[sba_certified_8a_joint_venture],
[CSISModifiedDate]=S.[CSISmodifiedDate],
[CSIStransactionID]=S.[CSIStransactionID],
NA=S.[CSISstage2id]
FROM Contract.FPDS as T
INNER Join ErrorLogging.FPDSviolatesConstraint as S
ON s.Unique_Transaction_ID=t.Unique_Transaction_ID and
s.Fiscal_Year=t.Fiscal_Year
WHERE s.last_modified_date>=t.last_modified_date
