ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [a_76_fair_act_action_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [action_date] [datetime2](7)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [action_type_description] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [awarding_agency_name] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [awarding_office_name] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [awarding_sub_tier_agency_n] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [clinger_cohen_act_pla_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [commercial_item_acqui_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [commercial_item_test_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [consolidated_contract_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [construction_wage_rat_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [contingency_humanitar_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [contract_award_type_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [contract_bundling_descrip] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [contract_financing_descrip] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [contracting_officers_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [cost_accounting_stand_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [cost_or_pricing_data_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [country_of_product_or_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [dod_claimant_prog_cod_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [domestic_or_foreign_e_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [epa_designated_produc_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [evaluated_preference_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [extent_compete_description] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [fair_opportunity_limi_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [fed_biz_opps_description] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [foreign_funding_desc] [varchar](25)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [funding_agency_name] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [funding_office_name] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [funding_sub_tier_agency_na] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [government_furnished_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [idv_type_description] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [information_technolog_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [inherently_government_desc] [varchar](40)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [interagency_contract_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [labor_standards_descrip] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [legal_entity_country_name] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [legal_entity_state_descrip] [varchar](35)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [local_area_set_aside_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [materials_supplies_descrip] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [multi_year_contract_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [multiple_or_single_aw_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [naics_description] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [national_interest_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [ordering_period_end_date] [datetime2](7)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [other_than_full_and_o_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [performance_based_se_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [period_of_performance_star] [datetime2](7)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [place_of_manufacture_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [place_of_perf_country_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [place_of_perfor_state_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [product_or_service_co_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [purchase_card_as_paym_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [recovered_materials_s_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [referenced_idv_agency_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [referenced_idv_type_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [referenced_mult_or_si_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [research_description] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [sam_exception] [varchar](70)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [sam_exception_description] [varchar](71)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [sea_transportation_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [solicitation_procedur_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [subcontracting_plan_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [type_of_contract_pric_desc] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [type_of_idc_description] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [type_set_aside_description] [varchar](255)

ALTER TABLE Errorlogging.source_procurement_transaction
ALTER COLUMN [undefinitized_action_desc] [varchar](255)

--Check across all non-varchar and non-bit destination types for failed tryconverts. Note you have to remove an extraneous comma from the first item.
SELECT
	,max(iif(Try_Convert([varchar](255), [a_76_fair_act_action_desc]) is null and
		nullif([a_76_fair_act_action_desc],'') is not null,1,0)) as [a_76_fair_act_action_desc]
	,max(iif(Try_Convert([datetime2](7), nullif([action_date],'')) is null and
		nullif([action_date],'') is not null,1,0)) as [action_date]
	,max(iif(Try_Convert([varchar](255), [action_type_description]) is null and
		nullif([action_type_description],'') is not null,1,0)) as [action_type_description]
	,max(iif(Try_Convert([varchar](255), [awarding_agency_name]) is null and
		nullif([awarding_agency_name],'') is not null,1,0)) as [awarding_agency_name]
	,max(iif(Try_Convert([varchar](255), [awarding_office_name]) is null and
		nullif([awarding_office_name],'') is not null,1,0)) as [awarding_office_name]
	,max(iif(Try_Convert([varchar](255), [awarding_sub_tier_agency_n]) is null and
		nullif([awarding_sub_tier_agency_n],'') is not null,1,0)) as [awarding_sub_tier_agency_n]
	,max(iif(Try_Convert([varchar](255), [clinger_cohen_act_pla_desc]) is null and
		nullif([clinger_cohen_act_pla_desc],'') is not null,1,0)) as [clinger_cohen_act_pla_desc]
	,max(iif(Try_Convert([varchar](255), [commercial_item_acqui_desc]) is null and
		nullif([commercial_item_acqui_desc],'') is not null,1,0)) as [commercial_item_acqui_desc]
	,max(iif(Try_Convert([varchar](255), [commercial_item_test_desc]) is null and
		nullif([commercial_item_test_desc],'') is not null,1,0)) as [commercial_item_test_desc]
	,max(iif(Try_Convert([varchar](255), [consolidated_contract_desc]) is null and
		nullif([consolidated_contract_desc],'') is not null,1,0)) as [consolidated_contract_desc]
	,max(iif(Try_Convert([varchar](255), [construction_wage_rat_desc]) is null and
		nullif([construction_wage_rat_desc],'') is not null,1,0)) as [construction_wage_rat_desc]
	,max(iif(Try_Convert([varchar](255), [contingency_humanitar_desc]) is null and
		nullif([contingency_humanitar_desc],'') is not null,1,0)) as [contingency_humanitar_desc]
	,max(iif(Try_Convert([varchar](255), [contract_award_type_desc]) is null and
		nullif([contract_award_type_desc],'') is not null,1,0)) as [contract_award_type_desc]
	,max(iif(Try_Convert([varchar](255), [contract_bundling_descrip]) is null and
		nullif([contract_bundling_descrip],'') is not null,1,0)) as [contract_bundling_descrip]
	,max(iif(Try_Convert([varchar](255), [contract_financing_descrip]) is null and
		nullif([contract_financing_descrip],'') is not null,1,0)) as [contract_financing_descrip]
	,max(iif(Try_Convert([varchar](255), [contracting_officers_desc]) is null and
		nullif([contracting_officers_desc],'') is not null,1,0)) as [contracting_officers_desc]
	,max(iif(Try_Convert([varchar](255), [cost_accounting_stand_desc]) is null and
		nullif([cost_accounting_stand_desc],'') is not null,1,0)) as [cost_accounting_stand_desc]
	,max(iif(Try_Convert([varchar](255), [cost_or_pricing_data_desc]) is null and
		nullif([cost_or_pricing_data_desc],'') is not null,1,0)) as [cost_or_pricing_data_desc]
	,max(iif(Try_Convert([varchar](255), [country_of_product_or_desc]) is null and
		nullif([country_of_product_or_desc],'') is not null,1,0)) as [country_of_product_or_desc]
	,max(iif(Try_Convert([varchar](255), [dod_claimant_prog_cod_desc]) is null and
		nullif([dod_claimant_prog_cod_desc],'') is not null,1,0)) as [dod_claimant_prog_cod_desc]
	,max(iif(Try_Convert([varchar](255), [domestic_or_foreign_e_desc]) is null and
		nullif([domestic_or_foreign_e_desc],'') is not null,1,0)) as [domestic_or_foreign_e_desc]
	,max(iif(Try_Convert([varchar](255), [epa_designated_produc_desc]) is null and
		nullif([epa_designated_produc_desc],'') is not null,1,0)) as [epa_designated_produc_desc]
	,max(iif(Try_Convert([varchar](255), [evaluated_preference_desc]) is null and
		nullif([evaluated_preference_desc],'') is not null,1,0)) as [evaluated_preference_desc]
	,max(iif(Try_Convert([varchar](255), [extent_compete_description]) is null and
		nullif([extent_compete_description],'') is not null,1,0)) as [extent_compete_description]
	,max(iif(Try_Convert([varchar](255), [fair_opportunity_limi_desc]) is null and
		nullif([fair_opportunity_limi_desc],'') is not null,1,0)) as [fair_opportunity_limi_desc]
	,max(iif(Try_Convert([varchar](255), [fed_biz_opps_description]) is null and
		nullif([fed_biz_opps_description],'') is not null,1,0)) as [fed_biz_opps_description]
	,max(iif(Try_Convert([varchar](25), [foreign_funding_desc]) is null and
		nullif([foreign_funding_desc],'') is not null,1,0)) as [foreign_funding_desc]
	,max(iif(Try_Convert([varchar](255), [funding_agency_name]) is null and
		nullif([funding_agency_name],'') is not null,1,0)) as [funding_agency_name]
	,max(iif(Try_Convert([varchar](255), [funding_office_name]) is null and
		nullif([funding_office_name],'') is not null,1,0)) as [funding_office_name]
	,max(iif(Try_Convert([varchar](255), [funding_sub_tier_agency_na]) is null and
		nullif([funding_sub_tier_agency_na],'') is not null,1,0)) as [funding_sub_tier_agency_na]
	,max(iif(Try_Convert([varchar](255), [government_furnished_desc]) is null and
		nullif([government_furnished_desc],'') is not null,1,0)) as [government_furnished_desc]
	,max(iif(Try_Convert([varchar](255), [idv_type_description]) is null and
		nullif([idv_type_description],'') is not null,1,0)) as [idv_type_description]
	,max(iif(Try_Convert([varchar](255), [information_technolog_desc]) is null and
		nullif([information_technolog_desc],'') is not null,1,0)) as [information_technolog_desc]
	,max(iif(Try_Convert([varchar](40), [inherently_government_desc]) is null and
		nullif([inherently_government_desc],'') is not null,1,0)) as [inherently_government_desc]
	,max(iif(Try_Convert([varchar](255), [interagency_contract_desc]) is null and
		nullif([interagency_contract_desc],'') is not null,1,0)) as [interagency_contract_desc]
	,max(iif(Try_Convert([varchar](255), [labor_standards_descrip]) is null and
		nullif([labor_standards_descrip],'') is not null,1,0)) as [labor_standards_descrip]
	,max(iif(Try_Convert([varchar](255), [legal_entity_country_name]) is null and
		nullif([legal_entity_country_name],'') is not null,1,0)) as [legal_entity_country_name]
	,max(iif(Try_Convert([varchar](35), [legal_entity_state_descrip]) is null and
		nullif([legal_entity_state_descrip],'') is not null,1,0)) as [legal_entity_state_descrip]
	,max(iif(Try_Convert([varchar](255), [local_area_set_aside_desc]) is null and
		nullif([local_area_set_aside_desc],'') is not null,1,0)) as [local_area_set_aside_desc]
	,max(iif(Try_Convert([varchar](255), [materials_supplies_descrip]) is null and
		nullif([materials_supplies_descrip],'') is not null,1,0)) as [materials_supplies_descrip]
	,max(iif(Try_Convert([varchar](255), [multi_year_contract_desc]) is null and
		nullif([multi_year_contract_desc],'') is not null,1,0)) as [multi_year_contract_desc]
	,max(iif(Try_Convert([varchar](255), [multiple_or_single_aw_desc]) is null and
		nullif([multiple_or_single_aw_desc],'') is not null,1,0)) as [multiple_or_single_aw_desc]
	,max(iif(Try_Convert([varchar](255), [naics_description]) is null and
		nullif([naics_description],'') is not null,1,0)) as [naics_description]
	,max(iif(Try_Convert([varchar](255), [national_interest_desc]) is null and
		nullif([national_interest_desc],'') is not null,1,0)) as [national_interest_desc]
	,max(iif(Try_Convert([datetime2](7), nullif([ordering_period_end_date],'')) is null and
		nullif([ordering_period_end_date],'') is not null,1,0)) as [ordering_period_end_date]
	,max(iif(Try_Convert([varchar](255), [other_than_full_and_o_desc]) is null and
		nullif([other_than_full_and_o_desc],'') is not null,1,0)) as [other_than_full_and_o_desc]
	,max(iif(Try_Convert([varchar](255), [performance_based_se_desc]) is null and
		nullif([performance_based_se_desc],'') is not null,1,0)) as [performance_based_se_desc]
	,max(iif(Try_Convert([datetime2](7), nullif([period_of_performance_star],'')) is null and
		nullif([period_of_performance_star],'') is not null,1,0)) as [period_of_performance_star]
	,max(iif(Try_Convert([varchar](255), [place_of_manufacture_desc]) is null and
		nullif([place_of_manufacture_desc],'') is not null,1,0)) as [place_of_manufacture_desc]
	,max(iif(Try_Convert([varchar](255), [place_of_perf_country_desc]) is null and
		nullif([place_of_perf_country_desc],'') is not null,1,0)) as [place_of_perf_country_desc]
	,max(iif(Try_Convert([varchar](255), [place_of_perfor_state_desc]) is null and
		nullif([place_of_perfor_state_desc],'') is not null,1,0)) as [place_of_perfor_state_desc]
	,max(iif(Try_Convert([varchar](255), [product_or_service_co_desc]) is null and
		nullif([product_or_service_co_desc],'') is not null,1,0)) as [product_or_service_co_desc]
	,max(iif(Try_Convert([varchar](255), [purchase_card_as_paym_desc]) is null and
		nullif([purchase_card_as_paym_desc],'') is not null,1,0)) as [purchase_card_as_paym_desc]
	,max(iif(Try_Convert([varchar](255), [recovered_materials_s_desc]) is null and
		nullif([recovered_materials_s_desc],'') is not null,1,0)) as [recovered_materials_s_desc]
	,max(iif(Try_Convert([varchar](255), [referenced_idv_agency_desc]) is null and
		nullif([referenced_idv_agency_desc],'') is not null,1,0)) as [referenced_idv_agency_desc]
	,max(iif(Try_Convert([varchar](255), [referenced_idv_type_desc]) is null and
		nullif([referenced_idv_type_desc],'') is not null,1,0)) as [referenced_idv_type_desc]
	,max(iif(Try_Convert([varchar](255), [referenced_mult_or_si_desc]) is null and
		nullif([referenced_mult_or_si_desc],'') is not null,1,0)) as [referenced_mult_or_si_desc]
	,max(iif(Try_Convert([varchar](255), [research_description]) is null and
		nullif([research_description],'') is not null,1,0)) as [research_description]
	,max(iif(Try_Convert([varchar](71), [sam_exception_description]) is null and
		nullif([sam_exception_description],'') is not null,1,0)) as [sam_exception_description]
	,max(iif(Try_Convert([varchar](255), [sea_transportation_desc]) is null and
		nullif([sea_transportation_desc],'') is not null,1,0)) as [sea_transportation_desc]
	,max(iif(Try_Convert([varchar](255), [solicitation_procedur_desc]) is null and
		nullif([solicitation_procedur_desc],'') is not null,1,0)) as [solicitation_procedur_desc]
	,max(iif(Try_Convert([varchar](255), [subcontracting_plan_desc]) is null and
		nullif([subcontracting_plan_desc],'') is not null,1,0)) as [subcontracting_plan_desc]
	,max(iif(Try_Convert([varchar](255), [type_of_contract_pric_desc]) is null and
		nullif([type_of_contract_pric_desc],'') is not null,1,0)) as [type_of_contract_pric_desc]
	,max(iif(Try_Convert([varchar](255), [type_of_idc_description]) is null and
		nullif([type_of_idc_description],'') is not null,1,0)) as [type_of_idc_description]
	,max(iif(Try_Convert([varchar](255), [type_set_aside_description]) is null and
		nullif([type_set_aside_description],'') is not null,1,0)) as [type_set_aside_description]
	,max(iif(Try_Convert([varchar](255), [undefinitized_action_desc]) is null and
		nullif([undefinitized_action_desc],'') is not null,1,0)) as [undefinitized_action_desc]
	FROM Errorlogging.source_procurement_transaction

--Varchar to varchar group check. Note you have to remove an extraneous comma from the first item. 
SELECT
 ,iif([sam_exception]>70,[sam_exception],NULL) as [sam_exception] 
FROM (SELECT
 	,max(len([sam_exception])) as [sam_exception] 
	FROM  Errorlogging . source_procurement_transaction ) as ml

