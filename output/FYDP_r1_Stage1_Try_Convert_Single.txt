SELECT DISTINCT [PByear],
len([PByear]) as Length,
'[smallint]' as DestinationType
FROM Budget.r1_long
WHERE (Try_Convert([smallint], Try_Convert(real,nullif([PByear],''))) IS NULL AND
NULLIF([PByear],'') IS NOT NULL)

ALTER TABLE Budget.r1_long
ALTER COLUMN [PByear] [smallint]

SELECT DISTINCT [AccountDSI],
len([AccountDSI]) as Length,
'[varchar](5)' as DestinationType
FROM Budget.r1_long
WHERE (Try_Convert([varchar](5), [AccountDSI]) IS NULL AND
NULLIF([AccountDSI],'') IS NOT NULL) OR
 len([AccountDSI]) > 5

ALTER TABLE Budget.r1_long
ALTER COLUMN [AccountDSI] [varchar](5)

SELECT DISTINCT [MainAccountName],
len([MainAccountName]) as Length,
'[varchar](45)' as DestinationType
FROM Budget.r1_long
WHERE (Try_Convert([varchar](45), [MainAccountName]) IS NULL AND
NULLIF([MainAccountName],'') IS NOT NULL) OR
 len([MainAccountName]) > 45

ALTER TABLE Budget.r1_long
ALTER COLUMN [MainAccountName] [varchar](45)

SELECT DISTINCT [Organization],
len([Organization]) as Length,
'[varchar](5)' as DestinationType
FROM Budget.r1_long
WHERE (Try_Convert([varchar](5), [Organization]) IS NULL AND
NULLIF([Organization],'') IS NOT NULL) OR
 len([Organization]) > 5

ALTER TABLE Budget.r1_long
ALTER COLUMN [Organization] [varchar](5)

SELECT DISTINCT [BudgetActivity],
len([BudgetActivity]) as Length,
'[smallint]' as DestinationType
FROM Budget.r1_long
WHERE (Try_Convert([smallint], Try_Convert(real,nullif([BudgetActivity],''))) IS NULL AND
NULLIF([BudgetActivity],'') IS NOT NULL)

ALTER TABLE Budget.r1_long
ALTER COLUMN [BudgetActivity] [smallint]

SELECT DISTINCT [BudgetActivityTitle],
len([BudgetActivityTitle]) as Length,
'[varchar](48)' as DestinationType
FROM Budget.r1_long
WHERE (Try_Convert([varchar](48), [BudgetActivityTitle]) IS NULL AND
NULLIF([BudgetActivityTitle],'') IS NOT NULL) OR
 len([BudgetActivityTitle]) > 48

ALTER TABLE Budget.r1_long
ALTER COLUMN [BudgetActivityTitle] [varchar](48)

SELECT DISTINCT [ProgramElement],
len([ProgramElement]) as Length,
'[varchar](10)' as DestinationType
FROM Budget.r1_long
WHERE (Try_Convert([varchar](10), [ProgramElement]) IS NULL AND
NULLIF([ProgramElement],'') IS NOT NULL) OR
 len([ProgramElement]) > 10

ALTER TABLE Budget.r1_long
ALTER COLUMN [ProgramElement] [varchar](10)

SELECT DISTINCT [ProgramElementTitle],
len([ProgramElementTitle]) as Length,
'[varchar](80)' as DestinationType
FROM Budget.r1_long
WHERE (Try_Convert([varchar](80), [ProgramElementTitle]) IS NULL AND
NULLIF([ProgramElementTitle],'') IS NOT NULL) OR
 len([ProgramElementTitle]) > 80

ALTER TABLE Budget.r1_long
ALTER COLUMN [ProgramElementTitle] [varchar](80)

SELECT DISTINCT [Classified],
len([Classified]) as Length,
'[varchar](20)' as DestinationType
FROM Budget.r1_long
WHERE (Try_Convert([varchar](20), [Classified]) IS NULL AND
NULLIF([Classified],'') IS NOT NULL) OR
 len([Classified]) > 20

ALTER TABLE Budget.r1_long
ALTER COLUMN [Classified] [varchar](20)

SELECT DISTINCT [FiscalYear],
len([FiscalYear]) as Length,
'[smallint]' as DestinationType
FROM Budget.r1_long
WHERE (Try_Convert([smallint], Try_Convert(real,nullif([FiscalYear],''))) IS NULL AND
NULLIF([FiscalYear],'') IS NOT NULL)

ALTER TABLE Budget.r1_long
ALTER COLUMN [FiscalYear] [smallint]

SELECT DISTINCT [LineNumber],
len([LineNumber]) as Length,
'[int]' as DestinationType
FROM Budget.r1_long
WHERE (Try_Convert([int], [LineNumber]) IS NULL AND
NULLIF([LineNumber],'') IS NOT NULL)

ALTER TABLE Budget.r1_long
ALTER COLUMN [LineNumber] [int]

SELECT DISTINCT [IncludeInTOA],
len([IncludeInTOA]) as Length,
'[varchar](1)' as DestinationType
FROM Budget.r1_long
WHERE (Try_Convert([varchar](1), [IncludeInTOA]) IS NULL AND
NULLIF([IncludeInTOA],'') IS NOT NULL) OR
 len([IncludeInTOA]) > 1

ALTER TABLE Budget.r1_long
ALTER COLUMN [IncludeInTOA] [varchar](1)

