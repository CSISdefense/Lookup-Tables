-- Insert new [parent_award_agency_id] into FPDSTypeTable.AgencyID
INSERT INTO FPDSTypeTable.AgencyID
(AgencyID,AgencyIDtext)
SELECT fk.[parent_award_agency_id]
,max(fk.parent_award_agency_name) as AgencyIDtext
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.AgencyID as pk
On pk.AgencyID=fk.[parent_award_agency_id]
WHERE pk.AgencyID is NULL and fk.[parent_award_agency_id] is not null
GROUP BY fk.[parent_award_agency_id]

-- Insert new [awarding_agency_code] into agency.awarding_agency_code
INSERT INTO agency.awarding_agency_code
(awarding_agency_code,awarding_agency_name)
SELECT fk.[awarding_agency_code]
,max(fk.awarding_agency_name) as awarding_agency_name
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN agency.awarding_agency_code as pk
On pk.awarding_agency_code=fk.[awarding_agency_code]
WHERE pk.awarding_agency_code is NULL and fk.[awarding_agency_code] is not null
GROUP BY fk.[awarding_agency_code]

-- Insert new [awarding_sub_agency_code] into FPDSTypeTable.AgencyID
INSERT INTO FPDSTypeTable.AgencyID
(AgencyID,AgencyIDtext)
SELECT fk.[awarding_sub_agency_code]
,max(fk.awarding_sub_agency_name) as AgencyIDtext
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.AgencyID as pk
On pk.AgencyID=fk.[awarding_sub_agency_code]
WHERE pk.AgencyID is NULL and fk.[awarding_sub_agency_code] is not null
GROUP BY fk.[awarding_sub_agency_code]

-- Insert new [funding_agency_code] into FPDSTypeTable.AgencyID
INSERT INTO FPDSTypeTable.AgencyID
(AgencyID,AgencyIDtext)
SELECT fk.[funding_agency_code]
,max(fk.funding_agency_name) as AgencyIDtext
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.AgencyID as pk
On pk.AgencyID=fk.[funding_agency_code]
WHERE pk.AgencyID is NULL and fk.[funding_agency_code] is not null
GROUP BY fk.[funding_agency_code]

-- Insert new [funding_sub_agency_code] into FPDSTypeTable.AgencyID
INSERT INTO FPDSTypeTable.AgencyID
(AgencyID,AgencyIDtext)
SELECT fk.[funding_sub_agency_code]
,max(fk.funding_sub_agency_name) as AgencyIDtext
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.AgencyID as pk
On pk.AgencyID=fk.[funding_sub_agency_code]
WHERE pk.AgencyID is NULL and fk.[funding_sub_agency_code] is not null
GROUP BY fk.[funding_sub_agency_code]

-- Insert new [foreign_funding] into budget.FundedByForeignEntity
INSERT INTO budget.FundedByForeignEntity
(fundedbyforeignentity,foreign_funding_description)
SELECT fk.[foreign_funding]
,max(fk.foreign_funding_description) as foreign_funding_description
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN budget.FundedByForeignEntity as pk
On pk.fundedbyforeignentity=fk.[foreign_funding]
WHERE pk.fundedbyforeignentity is NULL and fk.[foreign_funding] is not null
GROUP BY fk.[foreign_funding]

-- Insert new [sam_exception] into Vendor.CCRexception
INSERT INTO Vendor.CCRexception
(CCRexception,sam_exception_description)
SELECT fk.[sam_exception]
,max(fk.sam_exception_description) as sam_exception_description
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Vendor.CCRexception as pk
On pk.CCRexception=fk.[sam_exception]
WHERE pk.CCRexception is NULL and fk.[sam_exception] is not null
GROUP BY fk.[sam_exception]

-- Insert new [recipient_duns] into Contractor.Dunsnumber
INSERT INTO Contractor.Dunsnumber
(DUNSnumber)
SELECT fk.[recipient_duns]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Contractor.Dunsnumber as pk
On pk.DUNSnumber=fk.[recipient_duns]
WHERE pk.DUNSnumber is NULL and fk.[recipient_duns] is not null
GROUP BY fk.[recipient_duns]

-- Insert new [recipient_name] into Vendor.VendorName
INSERT INTO Vendor.VendorName
(vendorname)
SELECT fk.[recipient_name]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Vendor.VendorName as pk
On pk.vendorname=fk.[recipient_name]
WHERE pk.vendorname is NULL and fk.[recipient_name] is not null
GROUP BY fk.[recipient_name]

-- Insert new [recipient_doing_business_as_name] into Vendor.VendorName
INSERT INTO Vendor.VendorName
(vendorname)
SELECT fk.[recipient_doing_business_as_name]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Vendor.VendorName as pk
On pk.vendorname=fk.[recipient_doing_business_as_name]
WHERE pk.vendorname is NULL and fk.[recipient_doing_business_as_name] is not null
GROUP BY fk.[recipient_doing_business_as_name]

-- Insert new [recipient_parent_name] into Vendor.VendorName
INSERT INTO Vendor.VendorName
(vendorname)
SELECT fk.[recipient_parent_name]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Vendor.VendorName as pk
On pk.vendorname=fk.[recipient_parent_name]
WHERE pk.vendorname is NULL and fk.[recipient_parent_name] is not null
GROUP BY fk.[recipient_parent_name]

-- Insert new [recipient_parent_duns] into Contractor.Dunsnumber
INSERT INTO Contractor.Dunsnumber
(DUNSnumber)
SELECT fk.[recipient_parent_duns]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Contractor.Dunsnumber as pk
On pk.DUNSnumber=fk.[recipient_parent_duns]
WHERE pk.DUNSnumber is NULL and fk.[recipient_parent_duns] is not null
GROUP BY fk.[recipient_parent_duns]

-- Insert new [recipient_country_code] into FPDSTypeTable.vendorcountrycode
INSERT INTO FPDSTypeTable.vendorcountrycode
(vendorcountrycode)
SELECT fk.[recipient_country_code]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.vendorcountrycode as pk
On pk.vendorcountrycode=fk.[recipient_country_code]
WHERE pk.vendorcountrycode is NULL and fk.[recipient_country_code] is not null
GROUP BY fk.[recipient_country_code]

-- Insert new [recipient_state_code] into Location.recipient_state_code
INSERT INTO Location.recipient_state_code
(recipient_state_code,recipient_state_name)
SELECT fk.[recipient_state_code]
,max(fk.recipient_state_name) as recipient_state_name
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Location.recipient_state_code as pk
On pk.recipient_state_code=fk.[recipient_state_code]
WHERE pk.recipient_state_code is NULL and fk.[recipient_state_code] is not null
GROUP BY fk.[recipient_state_code]

-- Insert new [primary_place_of_performance_country_code] into FPDSTypeTable.Country3LetterCode
INSERT INTO FPDSTypeTable.Country3LetterCode
(Country3LetterCode,Country3LetterCodeText)
SELECT fk.[primary_place_of_performance_country_code]
,max(fk.primary_place_of_performance_country_name) as Country3LetterCodeText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.Country3LetterCode as pk
On pk.Country3LetterCode=fk.[primary_place_of_performance_country_code]
WHERE pk.Country3LetterCode is NULL and fk.[primary_place_of_performance_country_code] is not null
GROUP BY fk.[primary_place_of_performance_country_code]

-- Insert new [primary_place_of_performance_state_code] into FPDSTypeTable.statecode
INSERT INTO FPDSTypeTable.statecode
(statecode,statecodeText)
SELECT fk.[primary_place_of_performance_state_code]
,max(fk.primary_place_of_performance_state_name) as statecodeText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.statecode as pk
On pk.statecode=fk.[primary_place_of_performance_state_code]
WHERE pk.statecode is NULL and fk.[primary_place_of_performance_state_code] is not null
GROUP BY fk.[primary_place_of_performance_state_code]

-- Insert new [award_type_code] into FPDSTypeTable.award_type_code
INSERT INTO FPDSTypeTable.award_type_code
(award_type_code,award_type_name)
SELECT fk.[award_type_code]
,max(fk.award_type) as award_type_name
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.award_type_code as pk
On pk.award_type_code=fk.[award_type_code]
WHERE pk.award_type_code is NULL and fk.[award_type_code] is not null
GROUP BY fk.[award_type_code]

-- Insert new [idv_type_code] into FPDSTypeTable.idv_type_code
INSERT INTO FPDSTypeTable.idv_type_code
(idv_type_code,idv_type_name)
SELECT fk.[idv_type_code]
,max(fk.idv_type) as idv_type_name
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.idv_type_code as pk
On pk.idv_type_code=fk.[idv_type_code]
WHERE pk.idv_type_code is NULL and fk.[idv_type_code] is not null
GROUP BY fk.[idv_type_code]

-- Insert new [multiple_or_single_award_idv_code] into FPDSTypeTable.multipleorsingleawardidc
INSERT INTO FPDSTypeTable.multipleorsingleawardidc
(multipleorsingleawardidc,multipleorsingleawardidcText)
SELECT fk.[multiple_or_single_award_idv_code]
,max(fk.multiple_or_single_award_idv) as multipleorsingleawardidcText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.multipleorsingleawardidc as pk
On pk.multipleorsingleawardidc=fk.[multiple_or_single_award_idv_code]
WHERE pk.multipleorsingleawardidc is NULL and fk.[multiple_or_single_award_idv_code] is not null
GROUP BY fk.[multiple_or_single_award_idv_code]

-- Insert new [type_of_idc_code] into FPDSTypeTable.TypeOfIDC
INSERT INTO FPDSTypeTable.TypeOfIDC
(typeofIDC,typeOfIDCdescription)
SELECT fk.[type_of_idc_code]
,max(fk.type_of_idc) as typeOfIDCdescription
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.TypeOfIDC as pk
On pk.typeofIDC=fk.[type_of_idc_code]
WHERE pk.typeofIDC is NULL and fk.[type_of_idc_code] is not null
GROUP BY fk.[type_of_idc_code]

-- Insert new [type_of_contract_pricing_code] into FPDSTypeTable.typeofcontractpricing
INSERT INTO FPDSTypeTable.typeofcontractpricing
(TypeOfContractPricing,TypeOfContractPricingText)
SELECT fk.[type_of_contract_pricing_code]
,max(fk.type_of_contract_pricing) as TypeOfContractPricingText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.typeofcontractpricing as pk
On pk.TypeOfContractPricing=fk.[type_of_contract_pricing_code]
WHERE pk.TypeOfContractPricing is NULL and fk.[type_of_contract_pricing_code] is not null
GROUP BY fk.[type_of_contract_pricing_code]

-- Insert new [action_type_code] into FPDSTypeTable.reasonformodification
INSERT INTO FPDSTypeTable.reasonformodification
(reasonformodification,reasonformodificationText)
SELECT fk.[action_type_code]
,max(fk.action_type) as reasonformodificationText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.reasonformodification as pk
On pk.reasonformodification=fk.[action_type_code]
WHERE pk.reasonformodification is NULL and fk.[action_type_code] is not null
GROUP BY fk.[action_type_code]

-- Insert new [product_or_service_code] into FPDSTypeTable.ProductOrServiceCode
INSERT INTO FPDSTypeTable.ProductOrServiceCode
(ProductOrServiceCode,ProductOrServiceCodeText)
SELECT fk.[product_or_service_code]
,max(fk.product_or_service_code_description) as ProductOrServiceCodeText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.ProductOrServiceCode as pk
On pk.ProductOrServiceCode=fk.[product_or_service_code]
WHERE pk.ProductOrServiceCode is NULL and fk.[product_or_service_code] is not null
GROUP BY fk.[product_or_service_code]

-- Insert new [contract_bundling_code] into FPDSTypeTable.contractbundling
INSERT INTO FPDSTypeTable.contractbundling
(contractbundling,contractbundlingText)
SELECT fk.[contract_bundling_code]
,max(fk.contract_bundling) as contractbundlingText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.contractbundling as pk
On pk.contractbundling=fk.[contract_bundling_code]
WHERE pk.contractbundling is NULL and fk.[contract_bundling_code] is not null
GROUP BY fk.[contract_bundling_code]

-- Insert new [dod_claimant_program_code] into FPDSTypeTable.ClaimantProgramCode
INSERT INTO FPDSTypeTable.ClaimantProgramCode
(ClaimantProgramCode,ClaimantProgramCodeText)
SELECT fk.[dod_claimant_program_code]
,max(fk.dod_claimant_program_description) as ClaimantProgramCodeText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.ClaimantProgramCode as pk
On pk.ClaimantProgramCode=fk.[dod_claimant_program_code]
WHERE pk.ClaimantProgramCode is NULL and fk.[dod_claimant_program_code] is not null
GROUP BY fk.[dod_claimant_program_code]

-- Insert new [naics_code] into FPDSTypeTable.PrincipalNaicsCode
INSERT INTO FPDSTypeTable.PrincipalNaicsCode
(principalnaicscode,principalnaicscodeText)
SELECT fk.[naics_code]
,max(fk.naics_description) as principalnaicscodeText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.PrincipalNaicsCode as pk
On pk.principalnaicscode=fk.[naics_code]
WHERE pk.principalnaicscode is NULL and fk.[naics_code] is not null
GROUP BY fk.[naics_code]

-- Insert new [recovered_materials_sustainability_code] into FPDSTypeTable.recoveredmaterialclauses
INSERT INTO FPDSTypeTable.recoveredmaterialclauses
(recoveredmaterialclauses,recoveredmaterialclausesText)
SELECT fk.[recovered_materials_sustainability_code]
,max(fk.recovered_materials_sustainability) as recoveredmaterialclausesText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.recoveredmaterialclauses as pk
On pk.recoveredmaterialclauses=fk.[recovered_materials_sustainability_code]
WHERE pk.recoveredmaterialclauses is NULL and fk.[recovered_materials_sustainability_code] is not null
GROUP BY fk.[recovered_materials_sustainability_code]

-- Insert new [domestic_or_foreign_entity_code] into Location.manufacturingorganizationtype
INSERT INTO Location.manufacturingorganizationtype
(manufacturingorganizationtype,manufacturingorganizationtypeText)
SELECT fk.[domestic_or_foreign_entity_code]
,max(fk.domestic_or_foreign_entity) as manufacturingorganizationtypeText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Location.manufacturingorganizationtype as pk
On pk.manufacturingorganizationtype=fk.[domestic_or_foreign_entity_code]
WHERE pk.manufacturingorganizationtype is NULL and fk.[domestic_or_foreign_entity_code] is not null
GROUP BY fk.[domestic_or_foreign_entity_code]

-- Insert new [dod_acquisition_program_code] into Project.SystemEquipmentCode
INSERT INTO Project.SystemEquipmentCode
(systemequipmentcode,systemequipmentcodeText)
SELECT fk.[dod_acquisition_program_code]
,max(fk.dod_acquisition_program_description) as systemequipmentcodeText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Project.SystemEquipmentCode as pk
On pk.systemequipmentcode=fk.[dod_acquisition_program_code]
WHERE pk.systemequipmentcode is NULL and fk.[dod_acquisition_program_code] is not null
GROUP BY fk.[dod_acquisition_program_code]

-- Insert new [information_technology_commercial_item_category_code] into FPDSTypeTable.informationtechnologycommercialitemcategory
INSERT INTO FPDSTypeTable.informationtechnologycommercialitemcategory
(informationtechnologycommercialitemcategory,informationtechnologycommercialitemcategoryText)
SELECT fk.[information_technology_commercial_item_category_code]
,max(fk.information_technology_commercial_item_category) as informationtechnologycommercialitemcategoryText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.informationtechnologycommercialitemcategory as pk
On pk.informationtechnologycommercialitemcategory=fk.[information_technology_commercial_item_category_code]
WHERE pk.informationtechnologycommercialitemcategory is NULL and fk.[information_technology_commercial_item_category_code] is not null
GROUP BY fk.[information_technology_commercial_item_category_code]

-- Insert new [epa_designated_product_code] into FPDSTypeTable.useofepadesignatedproducts
INSERT INTO FPDSTypeTable.useofepadesignatedproducts
(useofepadesignatedproducts,useofepadesignatedproductsText)
SELECT fk.[epa_designated_product_code]
,max(fk.epa_designated_product) as useofepadesignatedproductsText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.useofepadesignatedproducts as pk
On pk.useofepadesignatedproducts=fk.[epa_designated_product_code]
WHERE pk.useofepadesignatedproducts is NULL and fk.[epa_designated_product_code] is not null
GROUP BY fk.[epa_designated_product_code]

-- Insert new [country_of_product_or_service_origin_code] into FPDSTypeTable.Country3LetterCode
INSERT INTO FPDSTypeTable.Country3LetterCode
(Country3LetterCode,Country3LetterCodeText)
SELECT fk.[country_of_product_or_service_origin_code]
,max(fk.country_of_product_or_service_origin) as Country3LetterCodeText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.Country3LetterCode as pk
On pk.Country3LetterCode=fk.[country_of_product_or_service_origin_code]
WHERE pk.Country3LetterCode is NULL and fk.[country_of_product_or_service_origin_code] is not null
GROUP BY fk.[country_of_product_or_service_origin_code]

-- Insert new [place_of_manufacture_code] into FPDSTypeTable.PlaceOfManufacture
INSERT INTO FPDSTypeTable.PlaceOfManufacture
(PlaceOfManufacture,PlaceOfManufactureText)
SELECT fk.[place_of_manufacture_code]
,max(fk.place_of_manufacture) as PlaceOfManufactureText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.PlaceOfManufacture as pk
On pk.PlaceOfManufacture=fk.[place_of_manufacture_code]
WHERE pk.PlaceOfManufacture is NULL and fk.[place_of_manufacture_code] is not null
GROUP BY fk.[place_of_manufacture_code]

-- Insert new [subcontracting_plan_code] into FPDSTypeTable.subcontractplan
INSERT INTO FPDSTypeTable.subcontractplan
(subcontractplan,subcontractplanText)
SELECT fk.[subcontracting_plan_code]
,max(fk.subcontracting_plan) as subcontractplanText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.subcontractplan as pk
On pk.subcontractplan=fk.[subcontracting_plan_code]
WHERE pk.subcontractplan is NULL and fk.[subcontracting_plan_code] is not null
GROUP BY fk.[subcontracting_plan_code]

-- Insert new [extent_competed_code] into FPDSTypeTable.extentcompeted
INSERT INTO FPDSTypeTable.extentcompeted
(extentcompeted,extentcompetedText)
SELECT fk.[extent_competed_code]
,max(fk.extent_competed) as extentcompetedText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.extentcompeted as pk
On pk.extentcompeted=fk.[extent_competed_code]
WHERE pk.extentcompeted is NULL and fk.[extent_competed_code] is not null
GROUP BY fk.[extent_competed_code]

-- Insert new [solicitation_procedures_code] into FPDSTypeTable.solicitationprocedures
INSERT INTO FPDSTypeTable.solicitationprocedures
(solicitationprocedures,solicitationproceduresText)
SELECT fk.[solicitation_procedures_code]
,max(fk.solicitation_procedures) as solicitationproceduresText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.solicitationprocedures as pk
On pk.solicitationprocedures=fk.[solicitation_procedures_code]
WHERE pk.solicitationprocedures is NULL and fk.[solicitation_procedures_code] is not null
GROUP BY fk.[solicitation_procedures_code]

-- Insert new [type_of_set_aside_code] into FPDSTypeTable.typeofsetaside
INSERT INTO FPDSTypeTable.typeofsetaside
(typeofsetaside,typeofsetasideText)
SELECT fk.[type_of_set_aside_code]
,max(fk.type_of_set_aside) as typeofsetasideText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.typeofsetaside as pk
On pk.typeofsetaside=fk.[type_of_set_aside_code]
WHERE pk.typeofsetaside is NULL and fk.[type_of_set_aside_code] is not null
GROUP BY fk.[type_of_set_aside_code]

-- Insert new [evaluated_preference_code] into FPDSTypeTable.evaluatedpreference
INSERT INTO FPDSTypeTable.evaluatedpreference
(evaluatedpreference,evaluatedpreferenceText)
SELECT fk.[evaluated_preference_code]
,max(fk.evaluated_preference) as evaluatedpreferenceText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.evaluatedpreference as pk
On pk.evaluatedpreference=fk.[evaluated_preference_code]
WHERE pk.evaluatedpreference is NULL and fk.[evaluated_preference_code] is not null
GROUP BY fk.[evaluated_preference_code]

-- Insert new [research_code] into ProductOrServiceCode.Research_Code
INSERT INTO ProductOrServiceCode.Research_Code
(Research_Code,Research_Name)
SELECT fk.[research_code]
,max(fk.research) as Research_Name
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN ProductOrServiceCode.Research_Code as pk
On pk.Research_Code=fk.[research_code]
WHERE pk.Research_Code is NULL and fk.[research_code] is not null
GROUP BY fk.[research_code]

-- Insert new [fair_opportunity_limited_sources_code] into FPDSTypeTable.statutoryexceptiontofairopportunity
INSERT INTO FPDSTypeTable.statutoryexceptiontofairopportunity
(statutoryexceptiontofairopportunity,statutoryexceptiontofairopportunityText)
SELECT fk.[fair_opportunity_limited_sources_code]
,max(fk.fair_opportunity_limited_sources) as statutoryexceptiontofairopportunityText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.statutoryexceptiontofairopportunity as pk
On pk.statutoryexceptiontofairopportunity=fk.[fair_opportunity_limited_sources_code]
WHERE pk.statutoryexceptiontofairopportunity is NULL and fk.[fair_opportunity_limited_sources_code] is not null
GROUP BY fk.[fair_opportunity_limited_sources_code]

-- Insert new [other_than_full_and_open_competition_code] into FPDSTypeTable.reasonnotcompeted
INSERT INTO FPDSTypeTable.reasonnotcompeted
(reasonnotcompeted,reasonnotcompetedText)
SELECT fk.[other_than_full_and_open_competition_code]
,max(fk.other_than_full_and_open_competition) as reasonnotcompetedText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.reasonnotcompeted as pk
On pk.reasonnotcompeted=fk.[other_than_full_and_open_competition_code]
WHERE pk.reasonnotcompeted is NULL and fk.[other_than_full_and_open_competition_code] is not null
GROUP BY fk.[other_than_full_and_open_competition_code]

-- Insert new [simplified_procedures_for_certain_commercial_items_code] into FPDSTypeTable.simplified_procedures_for_certain_commercial_items_code
INSERT INTO FPDSTypeTable.simplified_procedures_for_certain_commercial_items_code
(simplified_procedures_for_certain_commercial_items_code,simplified_procedures_for_certain_commercial_items)
SELECT fk.[simplified_procedures_for_certain_commercial_items_code]
,max(fk.simplified_procedures_for_certain_commercial_items) as simplified_procedures_for_certain_commercial_items
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.simplified_procedures_for_certain_commercial_items_code as pk
On pk.simplified_procedures_for_certain_commercial_items_code=fk.[simplified_procedures_for_certain_commercial_items_code]
WHERE pk.simplified_procedures_for_certain_commercial_items_code is NULL and fk.[simplified_procedures_for_certain_commercial_items_code] is not null
GROUP BY fk.[simplified_procedures_for_certain_commercial_items_code]

-- Insert new [commercial_item_acquisition_procedures_code] into FPDSTypeTable.CommercialItemAcquisitionProcedures
INSERT INTO FPDSTypeTable.CommercialItemAcquisitionProcedures
(CommercialItemAcquisitionProcedures,CommercialItemAcquisitionProceduresText)
SELECT fk.[commercial_item_acquisition_procedures_code]
,max(fk.commercial_item_acquisition_procedures) as CommercialItemAcquisitionProceduresText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.CommercialItemAcquisitionProcedures as pk
On pk.CommercialItemAcquisitionProcedures=fk.[commercial_item_acquisition_procedures_code]
WHERE pk.CommercialItemAcquisitionProcedures is NULL and fk.[commercial_item_acquisition_procedures_code] is not null
GROUP BY fk.[commercial_item_acquisition_procedures_code]

-- Insert new [fed_biz_opps_code] into FPDSTypeTable.fedbizopps
INSERT INTO FPDSTypeTable.fedbizopps
(fedbizopps,fed_biz_opps_name)
SELECT fk.[fed_biz_opps_code]
,max(fk.fed_biz_opps) as fed_biz_opps_name
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.fedbizopps as pk
On pk.fedbizopps=fk.[fed_biz_opps_code]
WHERE pk.fedbizopps is NULL and fk.[fed_biz_opps_code] is not null
GROUP BY fk.[fed_biz_opps_code]

-- Insert new [local_area_set_aside_code] into Location.localareasetaside
INSERT INTO Location.localareasetaside
(localareasetaside,local_area_set_aside_name)
SELECT fk.[local_area_set_aside_code]
,max(fk.local_area_set_aside) as local_area_set_aside_name
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Location.localareasetaside as pk
On pk.localareasetaside=fk.[local_area_set_aside_code]
WHERE pk.localareasetaside is NULL and fk.[local_area_set_aside_code] is not null
GROUP BY fk.[local_area_set_aside_code]

-- Insert new [materials_supplies_articles_equipment_code] into FPDSTypeTable.walshhealyact
INSERT INTO FPDSTypeTable.walshhealyact
(walshhealyact,walshhealyactText)
SELECT fk.[materials_supplies_articles_equipment_code]
,max(fk.materials_supplies_articles_equipment) as walshhealyactText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.walshhealyact as pk
On pk.walshhealyact=fk.[materials_supplies_articles_equipment_code]
WHERE pk.walshhealyact is NULL and fk.[materials_supplies_articles_equipment_code] is not null
GROUP BY fk.[materials_supplies_articles_equipment_code]

-- Insert new [labor_standards_code] into FPDSTypeTable.servicecontractact
INSERT INTO FPDSTypeTable.servicecontractact
(servicecontractact,servicecontractactText)
SELECT fk.[labor_standards_code]
,max(fk.labor_standards) as servicecontractactText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.servicecontractact as pk
On pk.servicecontractact=fk.[labor_standards_code]
WHERE pk.servicecontractact is NULL and fk.[labor_standards_code] is not null
GROUP BY fk.[labor_standards_code]

-- Insert new [construction_wage_rate_requirements_code] into FPDSTypeTable.davisbaconact
INSERT INTO FPDSTypeTable.davisbaconact
(davisbaconact,davisbaconactText)
SELECT fk.[construction_wage_rate_requirements_code]
,max(fk.construction_wage_rate_requirements) as davisbaconactText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.davisbaconact as pk
On pk.davisbaconact=fk.[construction_wage_rate_requirements_code]
WHERE pk.davisbaconact is NULL and fk.[construction_wage_rate_requirements_code] is not null
GROUP BY fk.[construction_wage_rate_requirements_code]

-- Insert new [interagency_contracting_authority_code] into FPDSTypeTable.interagencycontractingauthority
INSERT INTO FPDSTypeTable.interagencycontractingauthority
(interagencycontractingauthority,interagencycontractingauthorityText)
SELECT fk.[interagency_contracting_authority_code]
,max(fk.interagency_contracting_authority) as interagencycontractingauthorityText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.interagencycontractingauthority as pk
On pk.interagencycontractingauthority=fk.[interagency_contracting_authority_code]
WHERE pk.interagencycontractingauthority is NULL and fk.[interagency_contracting_authority_code] is not null
GROUP BY fk.[interagency_contracting_authority_code]

-- Insert new [parent_award_type_code] into FPDSTypeTable.idv_type_code
INSERT INTO FPDSTypeTable.idv_type_code
(idv_type_code,idv_type_name)
SELECT fk.[parent_award_type_code]
,max(fk.parent_award_type) as idv_type_name
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.idv_type_code as pk
On pk.idv_type_code=fk.[parent_award_type_code]
WHERE pk.idv_type_code is NULL and fk.[parent_award_type_code] is not null
GROUP BY fk.[parent_award_type_code]

-- Insert new [parent_award_single_or_multiple_code] into FPDSTypeTable.multipleorsingleawardidc
INSERT INTO FPDSTypeTable.multipleorsingleawardidc
(multipleorsingleawardidc,multipleorsingleawardidcText)
SELECT fk.[parent_award_single_or_multiple_code]
,max(fk.parent_award_single_or_multiple) as multipleorsingleawardidcText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.multipleorsingleawardidc as pk
On pk.multipleorsingleawardidc=fk.[parent_award_single_or_multiple_code]
WHERE pk.multipleorsingleawardidc is NULL and fk.[parent_award_single_or_multiple_code] is not null
GROUP BY fk.[parent_award_single_or_multiple_code]

-- Insert new [major_program] into Contract.MajorProgramCode
INSERT INTO Contract.MajorProgramCode
(majorprogramcode)
SELECT fk.[major_program]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Contract.MajorProgramCode as pk
On pk.majorprogramcode=fk.[major_program]
WHERE pk.majorprogramcode is NULL and fk.[major_program] is not null
GROUP BY fk.[major_program]

-- Insert new [national_interest_action_code] into Assistance.NationalInterestActionCode
INSERT INTO Assistance.NationalInterestActionCode
(NationalInterestActionCode,National_Interest_Action_Name)
SELECT fk.[national_interest_action_code]
,max(fk.national_interest_action) as National_Interest_Action_Name
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Assistance.NationalInterestActionCode as pk
On pk.NationalInterestActionCode=fk.[national_interest_action_code]
WHERE pk.NationalInterestActionCode is NULL and fk.[national_interest_action_code] is not null
GROUP BY fk.[national_interest_action_code]

-- Insert new [cost_or_pricing_data_code] into FPDSTypeTable.costorpricingdata
INSERT INTO FPDSTypeTable.costorpricingdata
(costorpricingdata,costorpricingdataText)
SELECT fk.[cost_or_pricing_data_code]
,max(fk.cost_or_pricing_data) as costorpricingdataText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.costorpricingdata as pk
On pk.costorpricingdata=fk.[cost_or_pricing_data_code]
WHERE pk.costorpricingdata is NULL and fk.[cost_or_pricing_data_code] is not null
GROUP BY fk.[cost_or_pricing_data_code]

-- Insert new [cost_accounting_standards_clause_code] into FPDSTypeTable.CostAccountingStandardsClause
INSERT INTO FPDSTypeTable.CostAccountingStandardsClause
(CostAccountingStandardsClause,cost_accounting_standards_clause_name)
SELECT fk.[cost_accounting_standards_clause_code]
,max(fk.cost_accounting_standards_clause) as cost_accounting_standards_clause_name
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.CostAccountingStandardsClause as pk
On pk.CostAccountingStandardsClause=fk.[cost_accounting_standards_clause_code]
WHERE pk.CostAccountingStandardsClause is NULL and fk.[cost_accounting_standards_clause_code] is not null
GROUP BY fk.[cost_accounting_standards_clause_code]

-- Insert new [government_furnished_property_code] into FPDSTypeTable.gfe_gfp
INSERT INTO FPDSTypeTable.gfe_gfp
(gfe_gfp,gfe_gfpText)
SELECT fk.[government_furnished_property_code]
,max(fk.government_furnished_property) as gfe_gfpText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.gfe_gfp as pk
On pk.gfe_gfp=fk.[government_furnished_property_code]
WHERE pk.gfe_gfp is NULL and fk.[government_furnished_property_code] is not null
GROUP BY fk.[government_furnished_property_code]

-- Insert new [sea_transportation_code] into FPDSTypeTable.seatransportation
INSERT INTO FPDSTypeTable.seatransportation
(seatransportation,seatransportationText)
SELECT fk.[sea_transportation_code]
,max(fk.sea_transportation) as seatransportationText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.seatransportation as pk
On pk.seatransportation=fk.[sea_transportation_code]
WHERE pk.seatransportation is NULL and fk.[sea_transportation_code] is not null
GROUP BY fk.[sea_transportation_code]

-- Insert new [undefinitized_action_code] into FPDSTypeTable.lettercontract
INSERT INTO FPDSTypeTable.lettercontract
(LetterContract,UndefinitizedActionText)
SELECT fk.[undefinitized_action_code]
,max(fk.undefinitized_action) as UndefinitizedActionText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.lettercontract as pk
On pk.LetterContract=fk.[undefinitized_action_code]
WHERE pk.LetterContract is NULL and fk.[undefinitized_action_code] is not null
GROUP BY fk.[undefinitized_action_code]

-- Insert new [consolidated_contract_code] into Contract.consolidatedcontract
INSERT INTO Contract.consolidatedcontract
(consolidatedcontract,consolidated_contract_name)
SELECT fk.[consolidated_contract_code]
,max(fk.consolidated_contract) as consolidated_contract_name
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Contract.consolidatedcontract as pk
On pk.consolidatedcontract=fk.[consolidated_contract_code]
WHERE pk.consolidatedcontract is NULL and fk.[consolidated_contract_code] is not null
GROUP BY fk.[consolidated_contract_code]

-- Insert new [performance_based_service_acquisition_code] into FPDSTypeTable.PerformanceBasedServiceContract
INSERT INTO FPDSTypeTable.PerformanceBasedServiceContract
(performancebasedservicecontract,performancebasedservicecontractText)
SELECT fk.[performance_based_service_acquisition_code]
,max(fk.performance_based_service_acquisition) as performancebasedservicecontractText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.PerformanceBasedServiceContract as pk
On pk.performancebasedservicecontract=fk.[performance_based_service_acquisition_code]
WHERE pk.performancebasedservicecontract is NULL and fk.[performance_based_service_acquisition_code] is not null
GROUP BY fk.[performance_based_service_acquisition_code]

-- Insert new [contract_financing_code] into FPDSTypeTable.contractfinancing
INSERT INTO FPDSTypeTable.contractfinancing
(contractfinancing,contractfinancingText)
SELECT fk.[contract_financing_code]
,max(fk.contract_financing) as contractfinancingText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.contractfinancing as pk
On pk.contractfinancing=fk.[contract_financing_code]
WHERE pk.contractfinancing is NULL and fk.[contract_financing_code] is not null
GROUP BY fk.[contract_financing_code]

-- Insert new [contingency_humanitarian_or_peacekeeping_operation_code] into Assistance.ContingencyHumanitarianPeacekeepingOperation
INSERT INTO Assistance.ContingencyHumanitarianPeacekeepingOperation
(ContingencyHumanitarianPeacekeepingOperation,contingencyhumanitarianpeacekeepingoperationText)
SELECT fk.[contingency_humanitarian_or_peacekeeping_operation_code]
,max(fk.contingency_humanitarian_or_peacekeeping_operation) as contingencyhumanitarianpeacekeepingoperationText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Assistance.ContingencyHumanitarianPeacekeepingOperation as pk
On pk.ContingencyHumanitarianPeacekeepingOperation=fk.[contingency_humanitarian_or_peacekeeping_operation_code]
WHERE pk.ContingencyHumanitarianPeacekeepingOperation is NULL and fk.[contingency_humanitarian_or_peacekeeping_operation_code] is not null
GROUP BY fk.[contingency_humanitarian_or_peacekeeping_operation_code]

-- Insert new [contracting_officers_determination_of_business_size_code] into FPDSTypeTable.contractingofficerbusinesssizedetermination
INSERT INTO FPDSTypeTable.contractingofficerbusinesssizedetermination
(contractingofficerbusinesssizedetermination,ContractingOfficerBusinessSizeDeterminationText)
SELECT fk.[contracting_officers_determination_of_business_size_code]
,max(fk.contracting_officers_determination_of_business_size) as ContractingOfficerBusinessSizeDeterminationText
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.contractingofficerbusinesssizedetermination as pk
On pk.contractingofficerbusinesssizedetermination=fk.[contracting_officers_determination_of_business_size_code]
WHERE pk.contractingofficerbusinesssizedetermination is NULL and fk.[contracting_officers_determination_of_business_size_code] is not null
GROUP BY fk.[contracting_officers_determination_of_business_size_code]

-- Insert new [award_or_idv_flag] into Contract.award_or_idv_flag
INSERT INTO Contract.award_or_idv_flag
(award_or_idv_flag)
SELECT fk.[award_or_idv_flag]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Contract.award_or_idv_flag as pk
On pk.award_or_idv_flag=fk.[award_or_idv_flag]
WHERE pk.award_or_idv_flag is NULL and fk.[award_or_idv_flag] is not null
GROUP BY fk.[award_or_idv_flag]

-- Insert new [inherently_governmental_functions] into ProductOrServiceCode.inherently_governmental_functions
INSERT INTO ProductOrServiceCode.inherently_governmental_functions
(inherently_governmental_functions,inherently_governmental_functions_description)
SELECT fk.[inherently_governmental_functions]
,max(fk.inherently_governmental_functions_description) as inherently_governmental_functions_description
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN ProductOrServiceCode.inherently_governmental_functions as pk
On pk.inherently_governmental_functions=fk.[inherently_governmental_functions]
WHERE pk.inherently_governmental_functions is NULL and fk.[inherently_governmental_functions] is not null
GROUP BY fk.[inherently_governmental_functions]

-- Insert new [organizational_type] into Vendor.OrganizationalType
INSERT INTO Vendor.OrganizationalType
(OrganizationalType)
SELECT fk.[organizational_type]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Vendor.OrganizationalType as pk
On pk.OrganizationalType=fk.[organizational_type]
WHERE pk.OrganizationalType is NULL and fk.[organizational_type] is not null
GROUP BY fk.[organizational_type]

-- Insert new [contract_transaction_unique_key] into Contract.contract_transaction_unique_key
INSERT INTO Contract.contract_transaction_unique_key
(contract_transaction_unique_key)
SELECT fk.[contract_transaction_unique_key]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Contract.contract_transaction_unique_key as pk
On pk.contract_transaction_unique_key=fk.[contract_transaction_unique_key]
WHERE pk.contract_transaction_unique_key is NULL and fk.[contract_transaction_unique_key] is not null
GROUP BY fk.[contract_transaction_unique_key]

-- Insert new [contract_award_unique_key] into Contract.contract_award_unique_key
INSERT INTO Contract.contract_award_unique_key
(contract_award_unique_key)
SELECT fk.[contract_award_unique_key]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Contract.contract_award_unique_key as pk
On pk.contract_award_unique_key=fk.[contract_award_unique_key]
WHERE pk.contract_award_unique_key is NULL and fk.[contract_award_unique_key] is not null
GROUP BY fk.[contract_award_unique_key]

-- Insert new [recipient_uei] into Vendor.UEI
INSERT INTO Vendor.UEI
(UEI)
SELECT fk.[recipient_uei]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Vendor.UEI as pk
On pk.UEI=fk.[recipient_uei]
WHERE pk.UEI is NULL and fk.[recipient_uei] is not null
GROUP BY fk.[recipient_uei]

-- Insert new [recipient_parent_uei] into Vendor.UEI
INSERT INTO Vendor.UEI
(UEI)
SELECT fk.[recipient_parent_uei]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Vendor.UEI as pk
On pk.UEI=fk.[recipient_parent_uei]
WHERE pk.UEI is NULL and fk.[recipient_parent_uei] is not null
GROUP BY fk.[recipient_parent_uei]

-- Insert new [recipient_name_raw] into Vendor.VendorName
INSERT INTO Vendor.VendorName
(vendorname)
SELECT fk.[recipient_name_raw]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Vendor.VendorName as pk
On pk.vendorname=fk.[recipient_name_raw]
WHERE pk.vendorname is NULL and fk.[recipient_name_raw] is not null
GROUP BY fk.[recipient_name_raw]

-- Insert new [recipient_parent_name_raw] into Vendor.VendorName
INSERT INTO Vendor.VendorName
(vendorname)
SELECT fk.[recipient_parent_name_raw]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Vendor.VendorName as pk
On pk.vendorname=fk.[recipient_parent_name_raw]
WHERE pk.vendorname is NULL and fk.[recipient_parent_name_raw] is not null
GROUP BY fk.[recipient_parent_name_raw]

-- Insert new [prime_award_transaction_recipient_county_fips_code] into Location.County_FIPS_Code
INSERT INTO Location.County_FIPS_Code
(county_fips_code)
SELECT fk.[prime_award_transaction_recipient_county_fips_code]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Location.County_FIPS_Code as pk
On pk.county_fips_code=fk.[prime_award_transaction_recipient_county_fips_code]
WHERE pk.county_fips_code is NULL and fk.[prime_award_transaction_recipient_county_fips_code] is not null
GROUP BY fk.[prime_award_transaction_recipient_county_fips_code]

-- Insert new [prime_award_transaction_recipient_state_fips_code] into Location.State_FIPS_Code
INSERT INTO Location.State_FIPS_Code
(state_fips_code)
SELECT fk.[prime_award_transaction_recipient_state_fips_code]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Location.State_FIPS_Code as pk
On pk.state_fips_code=fk.[prime_award_transaction_recipient_state_fips_code]
WHERE pk.state_fips_code is NULL and fk.[prime_award_transaction_recipient_state_fips_code] is not null
GROUP BY fk.[prime_award_transaction_recipient_state_fips_code]

-- Insert new [prime_award_transaction_place_of_performance_county_fips_code] into Location.County_FIPS_Code
INSERT INTO Location.County_FIPS_Code
(county_fips_code)
SELECT fk.[prime_award_transaction_place_of_performance_county_fips_code]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Location.County_FIPS_Code as pk
On pk.county_fips_code=fk.[prime_award_transaction_place_of_performance_county_fips_code]
WHERE pk.county_fips_code is NULL and fk.[prime_award_transaction_place_of_performance_county_fips_code] is not null
GROUP BY fk.[prime_award_transaction_place_of_performance_county_fips_code]

-- Insert new [prime_award_transaction_place_of_performance_state_fips_code] into Location.State_FIPS_Code
INSERT INTO Location.State_FIPS_Code
(state_fips_code)
SELECT fk.[prime_award_transaction_place_of_performance_state_fips_code]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Location.State_FIPS_Code as pk
On pk.state_fips_code=fk.[prime_award_transaction_place_of_performance_state_fips_code]
WHERE pk.state_fips_code is NULL and fk.[prime_award_transaction_place_of_performance_state_fips_code] is not null
GROUP BY fk.[prime_award_transaction_place_of_performance_state_fips_code]

-- Insert new [prime_award_transaction_recipient_cd_original] into Location.Congressional_District
INSERT INTO Location.Congressional_District
(congressional_district)
SELECT fk.[prime_award_transaction_recipient_cd_original]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Location.Congressional_District as pk
On pk.congressional_district=fk.[prime_award_transaction_recipient_cd_original]
WHERE pk.congressional_district is NULL and fk.[prime_award_transaction_recipient_cd_original] is not null
GROUP BY fk.[prime_award_transaction_recipient_cd_original]

-- Insert new [prime_award_transaction_place_of_performance_cd_original] into Location.Congressional_District
INSERT INTO Location.Congressional_District
(congressional_district)
SELECT fk.[prime_award_transaction_place_of_performance_cd_original]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN Location.Congressional_District as pk
On pk.congressional_district=fk.[prime_award_transaction_place_of_performance_cd_original]
WHERE pk.congressional_district is NULL and fk.[prime_award_transaction_place_of_performance_cd_original] is not null
GROUP BY fk.[prime_award_transaction_place_of_performance_cd_original]

-- Insert new [agency_id] into FPDSTypeTable.AgencyID
INSERT INTO FPDSTypeTable.AgencyID
(AgencyID)
SELECT fk.[agency_id]
FROM ETL.FPDSdelta as fk
LEFT OUTER JOIN FPDSTypeTable.AgencyID as pk
On pk.AgencyID=fk.[agency_id]
WHERE pk.AgencyID is NULL and fk.[agency_id] is not null
GROUP BY fk.[agency_id]

